{"version":3,"file":"timelineShow.js","sources":["../../../src/types/timeline.ts","../../../src/store/timeline.ts","../../../src/components/timeline/timelineShow.vue"],"sourcesContent":["import { Job } from \"@/types/job\";\n\nexport interface ITimeline {\n  name: string;\n  condition: ITimelineCondition;\n  timeline: string;\n  codeFight: string;\n  create: string;\n}\n\nexport interface ITimelineCondition {\n  zoneId: string; //0=true\n  job: Job; //JobEnum.NONE=true\n}\n\nexport interface ITimelineLine {\n  time: number;\n  action: string;\n  sync?: RegExp;\n  show: boolean;\n  windowBefore: number;\n  windowAfter: number;\n  jump?: number;\n  alertAlready: boolean;\n  tts?: string;\n}\n\nexport enum TimelineConfigEnum {\n  显示范围 = \"displayDuration\",\n  变色时间 = \"discoloration\",\n  零后持续 = \"hold\",\n  战前准备 = \"preBattle\",\n  TTS提前量 = \"ttsAdvance\",\n  // 刷新频率 = \"refreshRateMs\",\n}\n\nexport type TimelineConfigTranslate = Record<TimelineConfigEnum, string>;\nexport type TimelineConfigValues = Record<TimelineConfigEnum, number>;\nexport type ShowStyleTranslate = Record<ShowStyleConfigEnum, string>;\nexport type ShowStyle = Record<ShowStyleConfigEnum, number>;\nexport enum ShowStyleConfigEnum {\n  总宽度 = \"--timeline-width\",\n  未到来缩放 = \"--normal-scale\",\n  即将到来缩放 = \"--up-coming-scale\",\n  字体尺寸 = \"--font-size\",\n  变色动画时间 = \"--tras-duration\",\n  未到来不透明度 = \"--opacity\",\n}\n","import { defineStore } from \"pinia\";\nimport Swal from \"sweetalert2\";\nimport \"@sweetalert2/theme-bootstrap-4/bootstrap-4.scss\";\nimport Util from \"../utils/util\";\nimport { FFIcon } from \"@/types/fflogs\";\nimport { ITimeline, ITimelineCondition, ITimelineLine, ShowStyle, ShowStyleTranslate, TimelineConfigEnum, TimelineConfigTranslate, TimelineConfigValues } from \"@/types/timeline\";\n\nclass Timeline implements ITimeline {\n  constructor(name: string, condition: ITimelineCondition, timeline: string, codeFight: string) {\n    if (Util.iconToJobEnum(condition.job as FFIcon)) {\n      //突然有一天数据格式不一致了 可能是fflogs改返回值了?\n      condition.job = Util.jobEnumToJob(Util.iconToJobEnum(condition.job as FFIcon));\n    }\n    this.name = name;\n    this.condition = condition;\n    this.timeline = timeline;\n    this.codeFight = codeFight;\n    this.create = new Date().toLocaleString();\n  }\n  name: string;\n  condition: ITimelineCondition;\n  timeline: string;\n  codeFight: string;\n  create: string;\n}\n\nconst configTranslate: TimelineConfigTranslate = {\n  [TimelineConfigEnum.显示范围]: \"显示范围（秒）\",\n  [TimelineConfigEnum.变色时间]: \"提前变色（秒）\",\n  [TimelineConfigEnum.零后持续]: \"后续保持（秒）\",\n  [TimelineConfigEnum.战前准备]: \"倒计时量（秒）\",\n  [TimelineConfigEnum.TTS提前量]: \"TTS预备（秒）\",\n  // [TimelineConfigEnum.刷新频率]: \"刷新率（毫秒）\",\n};\n\nconst configValues: TimelineConfigValues = {\n  [TimelineConfigEnum.显示范围]: 120,\n  [TimelineConfigEnum.变色时间]: 2.75,\n  [TimelineConfigEnum.零后持续]: 0.5,\n  [TimelineConfigEnum.战前准备]: 30,\n  [TimelineConfigEnum.TTS提前量]: 1,\n  // [TimelineConfigEnum.刷新频率]: 100,\n};\n\nconst showStyleTranslate: ShowStyleTranslate = {\n  \"--timeline-width\": \"时间轴宽度\",\n  \"--font-size\": \"字体大小\",\n  \"--normal-scale\": \"等待缩放\",\n  \"--up-coming-scale\": \"来临缩放\",\n  \"--opacity\": \"等待不透明度\",\n  \"--tras-duration\": \"动画时间\",\n};\n\nlet showStyle: ShowStyle = {\n  \"--timeline-width\": 180,\n  \"--font-size\": 18,\n  \"--opacity\": 0.33,\n  \"--normal-scale\": 0.5,\n  \"--up-coming-scale\": 1,\n  \"--tras-duration\": 1,\n};\n\nexport const useTimelineStore = defineStore(\"timeline\", {\n  state: () => {\n    return {\n      // reg: reg,\n      // timelineLegalRegular: new RegExp(reg, \"gm\"),\n      allTimelines: [] as ITimeline[],\n      configValues,\n      configTranslate,\n      settings: { api: \"\" },\n      filters: {},\n      showStyle,\n      showStyleTranslate,\n    };\n  },\n  getters: {},\n  actions: {\n    newTimeline(\n      title: string = \"Demo\",\n      condition: ITimelineCondition = { zoneId: \"0\", job: \"NONE\" },\n      rawTimeline: string = `# 注释的内容不会被解析\n# \"<技能名>\"会被解析为图片 紧接着一个波浪线可快捷重复技能名\n-20 \"<中间学派>~刷盾\"\n0 \"战斗开始\" tts \"冲呀\"\n# 当sync在window的范围内被满足时将进行时间同步\n30 \"一运\" sync / 14:4.{7}:[^:]*:AAAA:/ window 2.5,2.5\n# 当存在jump时会进跳转至jump时间\n50 \"变异化型:蛇\" sync / 14:4.{7}:[^:]*:BBBB:/ window 2.5,2.5 jump 1000\n50 \"变异化型:兽\" sync / 14:4.{7}:[^:]*:CCCC:/ window 2.5,2.5 jump 2000\n1000 \"蛇轴\"\n2000 \"兽轴\"\n`,\n      codeFight: string = \"用户创建\",\n    ): number {\n      this.allTimelines.push(new Timeline(title, condition, rawTimeline, codeFight));\n      this.sortTimelines();\n      Swal.fire({\n        position: \"center\",\n        icon: \"success\",\n        title: `“${title}”已创建`,\n        showConfirmButton: false,\n        timer: 1000,\n      });\n      //如果严谨点应该还要比较create 但重复的demo选错又能怎么样呢\n      const result = this.allTimelines.findIndex(\n        (t) => t.timeline === rawTimeline && t.name === title && JSON.stringify(t.condition) === JSON.stringify(condition) && t.codeFight === codeFight,\n      );\n      return result;\n    },\n    getTimeline(condition: ITimelineCondition): ITimeline[] {\n      return this.allTimelines.filter((t) => {\n        return (t.condition.zoneId === \"0\" || t.condition.zoneId === condition.zoneId) && (t.condition.job === \"NONE\" || t.condition.job === condition.job);\n      });\n    },\n    saveTimelineSettings() {\n      localStorage.setItem(\n        \"timelines\",\n        JSON.stringify({\n          allTimelines: this.allTimelines,\n          configValues: this.configValues,\n          settings: this.settings,\n          showStyle: this.showStyle,\n          filters: this.filters,\n        }),\n      );\n    },\n    loadTimelineSettings() {\n      const ls = localStorage.getItem(\"timelines\");\n      if (ls) {\n        Object.assign(this, JSON.parse(ls));\n        this.allTimelines.forEach((v) => {\n          if ((v.condition as any).jobList) {\n            v.condition.job = (v.condition as any).jobList[0] ?? \"NONE\";\n            delete (v.condition as any).jobList;\n          }\n        });\n        this.sortTimelines();\n      }\n      this.allTimelines.forEach((v) => {\n        //突然有一天数据格式不一致了 可能是fflogs改返回值了? 对现有数据进行修复\n        if (Util.iconToJobEnum(v.condition.job as FFIcon)) v.condition.job = Util.jobEnumToJob(Util.iconToJobEnum(v.condition.job as FFIcon));\n      });\n    },\n    sortTimelines() {\n      this.allTimelines.sort((a, b) => {\n        // a.condition.job === b.condition.job\n        //   ? Number(a.condition.zoneId) - Number(b.condition.zoneId)\n        //   : Util.jobToJobEnum(a.condition.job) - Util.jobToJobEnum(b.condition.job),\n        if (Number(a.condition.zoneId) === Number(b.condition.zoneId)) return Util.jobToJobEnum(a.condition.job) - Util.jobToJobEnum(b.condition.job);\n        return Number(a.condition.zoneId) - Number(b.condition.zoneId);\n      });\n    },\n  },\n});\n\nfunction parseTime(time: string): number {\n  const timeFormatType = time.match(/^(?<negative>-)?(?<mm>[^:：]+):(?<ss>[^:：]+)$/);\n  if (timeFormatType) {\n    return parseFloat(timeFormatType.groups!.mm) * 60 + parseFloat(timeFormatType.groups!.ss) * (timeFormatType.groups?.negative ? -1 : 1);\n  } else {\n    return parseFloat(time);\n  }\n}\nexport function parseAction(text: string) {\n  return text.matchAll(/\\<(?<name>[^\\<\\>]*?)!??\\>(?<repeat>~)?/g);\n}\n\nexport async function parseTimeline(rawTimeline: string): Promise<ITimelineLine[]> {\n  const total: ITimelineLine[] = [];\n  const matchs = [...rawTimeline.matchAll(/^\\s*(?<time>[-:：\\d.]+)\\s+(?<action>(?:--|[\"'“”])[^\"'\\n]+?(?:--|[\"'“”])).*$/gm)];\n  for (let i = 0; i < matchs.length; i++) {\n    const match = matchs[i];\n    const jump = match[0].match(/(?<=jump ?)[-:：\\d.]+/)?.[0];\n    const sync = match[0].match(/(?<=sync ?\\/).+(?=\\/)/)?.[0];\n    const windowBefore = match[0].match(/(?<=window ?)[-:：\\d.]+/)?.[0];\n    const windowAfter = match[0].match(/(?<=window ?[-:：\\d.]+,)[-:：\\d.]+/)?.[0];\n    const tts = match[0].match(/ tts ?[\"'“”](?<tts>[^\"'“”]+)[\"'“”]/)?.groups?.tts;\n    const ttsSim = / tts(?: |$)/.test(match[0]) ? Array.from(parseAction(match.groups!.action))?.[0]?.groups?.name : undefined;\n    \n    total.push({\n      time: parseTime(match.groups!.time),\n      action: match.groups!.action || \"\",\n      alertAlready: false,\n      sync: sync ? new RegExp(sync) : undefined,\n      show: !sync,\n      windowBefore: parseFloat(windowBefore || windowAfter || \"2.5\"),\n      windowAfter: parseFloat(windowAfter || windowBefore || \"2.5\"),\n      jump: jump ? parseFloat(jump) : undefined,\n      tts: tts || ttsSim,\n    });\n  }\n  total.sort((a, b) => a.time - b.time);\n  return total;\n}\n","<template>\n  <ul v-if=\"lines.length\" class=\"loadedTimelines\" :style=\"showStyle\">\n    <li\n      v-for=\"(item, index) in props.lines\"\n      :key=\"index\"\n      v-show=\"item.show && item.time - runtime > 0 - config.hold - showStyle['--tras-duration'] && item.time - runtime <= config.displayDuration\"\n      :class=\"{\n        upcoming: item.time - runtime <= config.discoloration,\n        fade: item.time - runtime <= 0 - config.hold,\n        passed: item.time - runtime <= 0,\n      }\"\n    >\n      <aside :style=\"{ right: Math.max((item.time - runtime) / config.displayDuration, 0) * 100 + '%' }\"></aside>\n      <section>\n        <span v-html=\"renderHTML(item.action)\"></span><span style=\"padding: 0px 1px\">{{ (item.time - runtime).toFixed(1) }} </span>\n      </section>\n    </li>\n  </ul>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ITimelineLine, ShowStyle, TimelineConfigValues } from \"@/types/timeline\";\nimport { parseAction } from \"@/store/timeline\";\nimport { getActionByChineseName, getFullImgSrc } from \"@/utils/xivapi\";\n\nconst props = defineProps<{\n  config: TimelineConfigValues;\n  lines: ITimelineLine[];\n  runtime: number;\n  showStyle: ShowStyle;\n}>();\n\nconst PLACEHOLDER =\n  \"data:image/png;base64,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\";\nconst imageMap: Record<string, unknown> = reactive({});\n\n// 在Vue组件内生成HTML是可以响应数据变化更新视图的\nfunction renderHTML(text: string): string {\n  text = text.replaceAll(/^[\"'“”]|[\"'“”]$/g, \"\");\n  const items = parseAction(text);\n  if (!items) return text;\n\n  for (const item of items) {\n    if (item.groups?.name) {\n      const src = getSkillImage(item.groups!.name);\n      text = text.replace(\n        item[0],\n        `${src ? `<div class=\"skill_icon\"><img src=\"${src}\" style=\"background-image: url('${PLACEHOLDER}')\" loading=\"auto\"/></div>` : \"\"}<span>${\n          item.groups?.repeat ? item.groups!.name : \"\"\n        }</span>`,\n      );\n    }\n  }\n\n  return text;\n}\n\n/**\n * 图片展示顺序说明：\n * 1、初次展示兜底图\n * 2、下载图片期间展示背景图\n * 3、下载图片完成展示图片\n * 4、下载图片出错展示兜底图\n */\nfunction getSkillImage(name: string): string {\n  if (typeof imageMap[name] === \"string\") {\n    return imageMap[name] as string;\n  }\n\n  if (typeof imageMap[name] === \"undefined\") {\n    //仅请求一次，无论成功失败都不会再调用\n    imageMap[name] = getActionByChineseName(name).then((res) => {\n      if (res?.Icon)\n        getFullImgSrc(res.Icon).then((url) => {\n          preloadImage(url)\n            .then(() => {\n              imageMap[name] = url;\n            })\n            .catch(() => {\n              imageMap[name] = PLACEHOLDER;\n            });\n        });\n    });\n  }\n\n  return PLACEHOLDER;\n}\n\n//一种在JS里判断图片下载成功或失败的方法\nfunction preloadImage(url: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve();\n    img.onerror = () => reject();\n    img.src = url;\n  });\n}\n</script>\n<style lang=\"scss\">\n::-webkit-scrollbar {\n  display: none !important;\n}\n</style>\n<style lang=\"scss\" scoped>\n* {\n  overflow: hidden;\n  box-sizing: border-box;\n}\n$timelineWitdh: 180;\n$fontSize: 18;\n$opacity: 0.33;\n$normalScale: 0.5;\n$upComingScale: 1;\n$trasDuration: 1;\n.loadedTimelines {\n  width: calc(1px * var(--timeline-width, $timelineWitdh));\n  list-style-type: none;\n  color: white;\n  text-shadow: -1px 0 1px #000, 0 1px 1px #000, 1px 0 1px #000, 0 -1px 1px #000;\n  font-family: \"Microsoft Yahei UI\";\n  margin: 0em;\n  padding: 0em 0.5em;\n  li {\n    overflow: hidden;\n    background-color: rgb(20, 22, 25);\n    margin-bottom: 1px;\n    border: 1px solid #000;\n    box-sizing: border-box;\n    position: relative;\n    opacity: var(--opacity, $opacity);\n    transition-duration: calc(var(--tras-duration, $trasDuration) * 1s);\n    height: calc(48px * var(--normal-scale, $normalScale));\n    &.fade {\n      animation: myfade calc(var(--tras-duration, $trasDuration) * 1s) 1 forwards !important;\n      height: calc(48px * var(--up-coming-scale, $upComingScale));\n    }\n    @keyframes myfade {\n      0% {\n        opacity: 1;\n        height: calc(48px * var(--up-coming-scale, $upComingScale));\n      }\n      50% {\n        opacity: 0;\n        height: calc(48px * var(--up-coming-scale, $upComingScale));\n      }\n      100% {\n        height: 0px;\n        opacity: 0;\n      }\n    }\n    &.passed {\n      // > aside {\n      > * {\n        animation: passed 0.34s 2 alternate;\n      }\n      // }\n      @keyframes passed {\n        0% {\n          filter: drop-shadow(0px 0px 0px black);\n        }\n        100% {\n          filter: drop-shadow(1px 2px 3px black);\n        }\n      }\n    }\n    &.upcoming {\n      font-family: \"SmartisanHei\", \"微软雅黑\";\n      opacity: 1;\n      font-weight: bold;\n      transition-property: all;\n      transition-duration: calc(var(--tras-duration, $trasDuration) * 1s);\n      transition-timing-function: ease;\n      height: calc(48px * var(--up-coming-scale, $upComingScale));\n      aside {\n        background-color: rgb(255, 136, 136);\n      }\n      :deep(span) {\n        font-size: calc(var(--font-size, $fontSize) * var(--up-coming-scale, $upComingScale) * 1px) !important;\n      }\n      span :deep(.skill_icon) {\n        transition-property: all;\n        transition-duration: calc(var(--tras-duration, $trasDuration) * 1s);\n        transition-timing-function: ease;\n        width: calc(48px * var(--up-coming-scale, $upComingScale));\n        height: calc(48px * var(--up-coming-scale, $upComingScale));\n        img {\n          transition-property: all;\n          transition-duration: calc(var(--tras-duration, $trasDuration) * 1s);\n          transition-timing-function: ease;\n          width: calc(40px * var(--up-coming-scale, $upComingScale));\n          height: calc(40px * var(--up-coming-scale, $upComingScale));\n          top: calc(4px * var(--up-coming-scale, $upComingScale));\n          left: calc(4px * var(--up-coming-scale, $upComingScale));\n        }\n        &::after {\n          transition-property: all;\n          transition-duration: calc(var(--tras-duration, $trasDuration) * 1s);\n          transition-timing-function: ease;\n          width: calc(48px * var(--up-coming-scale, $upComingScale));\n          height: calc(48px * var(--up-coming-scale, $upComingScale));\n        }\n      }\n    }\n    > aside {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: #88f;\n    }\n    section {\n      height: 100%;\n      position: relative;\n      padding: 0 2px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      font-size: calc(calc(var(--font-size, $fontSize) * 1px) * var(--normal-scale, $normalScale));\n      // font-size: calc(calc(var(--font-size, $fontSize) * 1px));\n      > span {\n        display: flex;\n        align-items: center;\n        overflow: hidden;\n        // &:first-of-type {\n        //   flex: 1;\n        // }\n        > :deep(span) {\n          // white-space: nowrap;\n          text-overflow: ellipsis;\n          overflow: hidden;\n          flex: 1;\n        }\n      }\n      > :deep(div) {\n        width: calc(40px * var(--up-coming-scale, 1));\n        height: calc(40px * var(--up-coming-scale, 1));\n        top: calc(4px * var(--up-coming-scale, 1));\n      }\n      span :deep(.skill_icon) {\n        position: relative;\n        top: 0px;\n        left: calc(-4px * var(--normal-scale, $normalScale));\n        width: calc(48px * var(--normal-scale, $normalScale));\n        height: calc(48px * var(--normal-scale, $normalScale));\n        img {\n          display: inline-block;\n          position: absolute;\n          width: calc(40px * var(--normal-scale, $normalScale));\n          height: calc(40px * var(--normal-scale, $normalScale));\n          top: calc(4px * var(--normal-scale, $normalScale));\n          left: calc(4px * var(--normal-scale, $normalScale));\n          z-index: 1;\n          background-size: contain;\n          background-repeat: no-repeat;\n          background-position: 0 0;\n        }\n        &::after {\n          content: \"\";\n          background: url(@/assets/frame.png) no-repeat;\n          background-size: cover;\n          width: calc(48px * var(--normal-scale, $normalScale));\n          height: calc(48px * var(--normal-scale, $normalScale));\n          display: inline-block;\n          position: absolute;\n          z-index: 2;\n        }\n      }\n    }\n  }\n}\n</style>\n"],"names":["TimelineConfigEnum","Timeline","name","condition","timeline","codeFight","Util","configTranslate","configValues","showStyleTranslate","showStyle","useTimelineStore","defineStore","title","rawTimeline","Swal","t","ls","v","a","b","parseTime","time","timeFormatType","_a","parseAction","text","parseTimeline","total","matchs","i","match","jump","sync","_b","windowBefore","_c","windowAfter","_d","tts","_f","_e","ttsSim","_i","_h","_g","PLACEHOLDER","imageMap","reactive","renderHTML","items","item","src","getSkillImage","getActionByChineseName","res","getFullImgSrc","url","preloadImage","resolve","reject","img"],"mappings":"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"}