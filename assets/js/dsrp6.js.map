{"version":3,"file":"dsrp6.js","sources":["../../../src/pages/dsrp6.vue"],"sourcesContent":["<template>\n  <div id=\"container\">\n    <main>\n      <ul v-if=\"actionTimeline.show\">\n        <li class=\"li-head\">\n          <aside>秒</aside>\n          <h5>邪龙</h5>\n          <h5>圣龙</h5>\n        </li>\n        <li class=\"li-main\" v-for=\"(second, i) in actionTimeline.data\" :key=\"i\">\n          <aside>{{ i }}</aside>\n          <div class=\"xie\">\n            {{ second?.xieHP ?? \"\" }}%<img v-for=\"(src, j) in second?.xie\" :key=\"j\" :src=\"src\" alt=\"\" />\n          </div>\n          <div class=\"sheng\">\n            {{ second?.shengHP ?? \"\" }}%<img v-for=\"(src, j) in second?.sheng\" :key=\"j\" :src=\"src\" alt=\"\" />\n          </div>\n        </li>\n      </ul>\n    </main>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { getImgSrcByActionId } from \"@/utils/xivapi\";\n\naddOverlayListener(\"LogLine\", handleLogLine);\nstartOverlayEvents();\nconst targetName = {\n  xie: [\"尼德霍格\", \"ニーズヘッグ\", \"Nidhogg\"],\n  sheng: [\"赫拉斯瓦尔格\", \"フレースヴェルグ\", \"Hraesvelgr\"],\n};\nconst actionTimeline: { show: boolean; data: { xie: string[]; xieHP: string; sheng: string[]; shengHP: string }[] } =\n  reactive({\n    data: [],\n    show: false,\n  });\nconst HP = { xie: 0, sheng: 0 };\nlet baseTime = 0;\nasync function handleLogLine(e: { line: string[] }): Promise<void> {\n  if (e.line[0] === \"20\" && /^6D41$/.test(e.line[4])) {\n    actionTimeline.data.length = 0;\n    actionTimeline.show = true;\n    actionTimeline.data.push({ xie: [], sheng: [], xieHP: \"0\", shengHP: \"0\" });\n    baseTime = new Date().getTime();\n    setTimeout(() => (baseTime = 0), 7700);\n  } else if (e.line[0] === \"20\" && /^(?:63C8|6D21)$/.test(e.line[4])) {\n    actionTimeline.data.length = 0;\n    actionTimeline.show = false;\n    actionTimeline.data.push({ xie: [], sheng: [], xieHP: \"0\", shengHP: \"0\" });\n  } else if (\n    baseTime > 0 &&\n    (e.line[0] === \"21\" || e.line[0] === \"22\") &&\n    e.line?.[2]?.[0] === \"1\" &&\n    e.line?.[6]?.[0] === \"4\"\n  ) {\n    if (e.line[4] === \"07\" || e.line[4] === \"08\") return;\n    const timeIndex = Math.round((new Date().getTime() - baseTime) / 1000);\n    if (actionTimeline.data[timeIndex] === undefined)\n      actionTimeline.data[timeIndex] = { xie: [], sheng: [], xieHP: HP.xie.toFixed(1), shengHP: HP.sheng.toFixed(1) };\n    const img = await getImgSrcByActionId(parseInt(e.line[4], 16));\n    if (targetName.xie.includes(e.line[7])) {\n      HP.xie = (Number(e.line[24]) / Number(e.line[25])) * 100;\n      actionTimeline.data[timeIndex].xie.push(img);\n      actionTimeline.data[timeIndex].xieHP = HP.xie.toFixed(1);\n    } else if (targetName.sheng.includes(e.line[7])) {\n      HP.sheng = (Number(e.line[24]) / Number(e.line[25])) * 100;\n      actionTimeline.data[timeIndex].sheng.push(img);\n      actionTimeline.data[timeIndex].shengHP = HP.sheng.toFixed(1);\n    }\n  }\n}\n</script>\n<style lang=\"scss\">\n::-webkit-scrollbar {\n  display: none !important;\n}\n</style>\n<style lang=\"scss\" scoped>\n#container {\n  * {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n  }\n  ul {\n    background-color: white;\n    border-top: 1px solid black;\n    .li-head {\n      display: flex;\n      h5 {\n        width: 260px;\n        display: flex;\n        flex-flow: wrap;\n        justify-content: center;\n      }\n    }\n    .li-main {\n      display: flex;\n      div {\n        width: 260px;\n        display: flex;\n        flex-flow: wrap;\n        border-left: 2px solid black;\n        border-top: 1px solid black;\n        border-bottom: 1px solid black;\n        border-right: 2px solid black;\n        img {\n          height: 20px;\n        }\n      }\n    }\n  }\n}\n</style>\n"],"names":["handleLogLine","targetName","actionTimeline","reactive","HP","baseTime","_b","_a","_d","_c","timeIndex","img","getImgSrcByActionId"],"mappings":"0eA0BA,mBAAA,UAAAA,CAAA,EACA,qBACA,MAAAC,EAAA,CAAmB,IAAA,CAAA,OAAA,SAAA,SAAA,EACgB,MAAA,CAAA,SAAA,WAAA,YAAA,CACS,EAE5CC,EAAAC,EAAA,CACW,KAAA,CAAA,EACA,KAAA,EACD,CAAA,EAEVC,EAAA,CAAA,IAAA,EAAA,MAAA,CAAA,EACA,IAAAC,EAAA,EACA,eAAAL,EAAA,EAAA,aACE,GAAA,EAAA,KAAA,CAAA,IAAA,MAAA,SAAA,KAAA,EAAA,KAAA,CAAA,CAAA,EACEE,EAAA,KAAA,OAAA,EACAA,EAAA,KAAA,GACAA,EAAA,KAAA,KAAA,CAAA,IAAA,CAAA,EAAA,MAAA,CAAA,EAAA,MAAA,IAAA,QAAA,GAAA,CAAA,EACAG,EAAA,IAAA,KAAA,EAAA,QAAA,EACA,WAAA,IAAAA,EAAA,EAAA,IAAA,UAAqC,EAAA,KAAA,CAAA,IAAA,MAAA,kBAAA,KAAA,EAAA,KAAA,CAAA,CAAA,EAErCH,EAAA,KAAA,OAAA,EACAA,EAAA,KAAA,GACAA,EAAA,KAAA,KAAA,CAAA,IAAA,CAAA,EAAA,MAAA,CAAA,EAAA,MAAA,IAAA,QAAA,GAAA,CAAA,UAAyEG,EAAA,IAAA,EAAA,KAAA,CAAA,IAAA,MAAA,EAAA,KAAA,CAAA,IAAA,SAAAC,GAAAC,EAAA,EAAA,OAAA,YAAAA,EAAA,KAAA,YAAAD,EAAA,MAAA,OAAAE,GAAAC,EAAA,EAAA,OAAA,YAAAA,EAAA,KAAA,YAAAD,EAAA,MAAA,IAAA,CAOzE,GAAA,EAAA,KAAA,CAAA,IAAA,MAAA,EAAA,KAAA,CAAA,IAAA,KAA8C,OAC9C,MAAAE,EAAA,KAAA,OAAA,IAAA,KAAA,EAAA,QAAA,EAAAL,GAAA,GAAA,EACAH,EAAA,KAAAQ,CAAA,IAAA,SACER,EAAA,KAAAQ,CAAA,EAAA,CAAA,IAAA,GAAA,MAAA,CAAA,EAAA,MAAAN,EAAA,IAAA,QAAA,CAAA,EAAA,QAAAA,EAAA,MAAA,QAAA,CAAA,IACF,MAAAO,EAAA,MAAAC,EAAA,SAAA,EAAA,KAAA,CAAA,EAAA,EAAA,CAAA,EACAX,EAAA,IAAA,SAAA,EAAA,KAAA,CAAA,CAAA,GACEG,EAAA,IAAA,OAAA,EAAA,KAAA,EAAA,CAAA,EAAA,OAAA,EAAA,KAAA,EAAA,CAAA,EAAA,IACAF,EAAA,KAAAQ,CAAA,EAAA,IAAA,KAAAC,CAAA,EACAT,EAAA,KAAAQ,CAAA,EAAA,MAAAN,EAAA,IAAA,QAAA,CAAA,GAAuDH,EAAA,MAAA,SAAA,EAAA,KAAA,CAAA,CAAA,IAEvDG,EAAA,MAAA,OAAA,EAAA,KAAA,EAAA,CAAA,EAAA,OAAA,EAAA,KAAA,EAAA,CAAA,EAAA,IACAF,EAAA,KAAAQ,CAAA,EAAA,MAAA,KAAAC,CAAA,EACAT,EAAA,KAAAQ,CAAA,EAAA,QAAAN,EAAA,MAAA,QAAA,CAAA,GAEJ"}