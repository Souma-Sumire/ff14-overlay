import{az as I,q as k,Y as j,b as P,o as y,e as E,t as c,s as G,aA as W,u as e,a1 as M,F as H,L as Y,y as r,G as q,H as J,d as K,aB as Q,a as o,c as X,w as a,x as w,aC as C,aD as ee,J as te,B as ne,ak as oe,N as se,al as ae,aE as le,aF as ce,ah as ie,as as re,ap as de,af as ue,C as pe,ag as _e}from"./vendor-34f6178f.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import{C as x}from"./content_type-52b79aff.js";import{a as he,r as fe}from"./overlay_plugin_api-409cb9ea.js";import{z as me}from"./zoneInfo-a419d684.js";const L=S=>(q("data-v-0fa1ae65"),S=S(),J(),S),we={class:"language-switcher"},ge={class:"select-wrapper"},be=L(()=>c("svg",{class:"globe-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[c("circle",{cx:"12",cy:"12",r:"10"}),c("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),c("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})],-1)),ve=["value"],Ce=L(()=>c("span",{class:"select-arrow"},null,-1)),ye={__name:"LanguageSwitcher",setup(S){const{locale:t,availableLocales:d}=I(),u={zhCn:"简体中文",en:"English",ja:"日本語"},_=k("user-locale",t.value);j(_,R=>{t.value=R});function g(){t.value=_.value}return P(()=>{t.value=_.value}),(R,T)=>(y(),E("div",we,[c("div",ge,[be,G(c("select",{"onUpdate:modelValue":T[0]||(T[0]=s=>M(_)?_.value=s:null),class:"language-select",onChange:g},[(y(!0),E(H,null,Y(e(d),(s,O)=>(y(),E("option",{key:O,value:s},r(u[s]),9,ve))),128))],544),[[W,e(_)]]),Ce])]))}},Se=A(ye,[["__scopeId","data-v-0fa1ae65"]]),Ve={class:"obs-container"},Ee={class:"card-header"},Re={key:1},Te={class:"card-header"},Oe={class:"status-info"},Ue={class:"button-container"},ke={class:"card-header"},Be=K({__name:"obs2",setup(S){const{t}=I(),d=k("obs-user-config",{host:4455,password:""}),u=k("obs-user-content-setting",[]),_=k("obs-is-first-time",!0),g=["Raids","UltimateRaids","Dungeons","Trials","VCDungeonFinder","DeepDungeons","Guildhests","DisciplesOfTheLand","Eureka","GrandCompany","QuestBattles","TreasureHunt","Pvp"];function R(){const h=["Raids","UltimateRaids"];if(_.value)_.value=!1,u.value=[...h.map(n=>({type:n,enter:!1,countdown:!0,combat:!1,leave:!0,wipe:!0})),...g.filter(n=>!h.includes(n)).map(n=>({type:n,enter:!1,countdown:!1,combat:!1,leave:!1,wipe:!1}))];else{u.value=u.value.filter(i=>g.includes(i.type));const n=g.filter(i=>!u.value.some(p=>p.type===i)).map(i=>h.includes(i)?{type:i,enter:!1,countdown:!0,combat:!1,leave:!0,wipe:!0}:{type:i,enter:!1,countdown:!1,combat:!1,leave:!1,wipe:!1});u.value.push(...n)}u.value.sort((n,i)=>g.indexOf(n.type)-g.indexOf(i.type))}class T{constructor(){this.handleConnectionError=()=>{this.status.connecting=!1,this.status.connected=!1,this.status.recording=!1,this.status.outputActive=!1,this.status.outputPath="",C.modal.close(),C.modal.message({title:t("OBS Connection"),content:t("OBS Connection Error"),status:"warning",duration:2e3})},this.handleConnectionClosed=()=>{this.status.connecting=!1,this.status.connected=!1,this.status.recording=!1,this.status.outputActive=!1,this.status.outputPath="",C.modal.close(),C.modal.message({title:t("OBS Connection"),content:t("OBS Connection Closed"),status:"warning",duration:2e3})},this.ws=new ee,this.status=te({connecting:!1,connected:!1,recording:!1,outputActive:!1,outputPath:""}),this.ws.on("ConnectionClosed",this.handleConnectionClosed),this.ws.on("ConnectionError",this.handleConnectionError),this.ws.on("RecordStateChanged",n=>{this.status.connected=!0,this.status.recording=n.outputState==="OBS_WEBSOCKET_OUTPUT_STARTED",this.status.outputActive=n.outputActive,this.status.outputPath=n.outputPath})}connect(){d.value.host&&d.value.password&&(this.status.connecting=!0,this.ws.connect(`ws://127.0.0.1:${d.value.host}`,d.value.password).then(()=>{this.ws.call("GetRecordStatus").then(n=>{this.status.recording=n.outputActive,this.status.outputActive=n.outputActive}),this.status.connected=!0,C.modal.close(),C.modal.message({title:t("OBS Connection"),content:t("OBS Connection Opened"),status:"success",duration:2e3})}).finally(()=>{this.status.connecting=!1}))}disconnect(){this.ws.disconnect()}startRecord(){this.ws.call("StartRecord")}stopRecord(){this.ws.call("StopRecord")}splitRecord(){this.ws.call("StopRecord").finally(()=>{setTimeout(()=>{this.ws.call("StartRecord")},1e3)})}}const s=new T,O=h=>{var p;const n=h.zoneID,i=(p=me[n])==null?void 0:p.contentType;for(const b in x)if(Object.prototype.hasOwnProperty.call(x,b)&&x[b]===i){$(b,"enter");return}};function $(h,n){const i=s.status.recording;if(u.value.find(p=>p.type===h&&p[n]))switch(n){case"enter":case"countdown":case"combat":i?s.splitRecord():s.startRecord();return;case"leave":case"wipe":i&&s.stopRecord()}}return P(()=>{s.connect(),he("ChangeZone",O),R()}),Q(()=>{s.disconnect(),fe("ChangeZone",O)}),(h,n)=>{const i=Se,p=ne,b=oe,v=se,z=ae,F=le,U=ce,B=ie,D=re,N=de,m=ue,V=pe,Z=_e;return y(),E("div",Ve,[c("header",null,[c("h1",null,r(e(t)("OBS Auto Record V2")),1),o(i)]),c("main",null,[e(s).status.connected?(y(),E("div",Re,[o(B,{class:"status-card"},{header:a(()=>[c("div",Te,[c("span",null,r(e(t)("Connection Status")),1),o(v,{type:"danger",size:"small",class:"disconnect-button",onClick:n[3]||(n[3]=l=>e(s).disconnect())},{default:a(()=>[w(r(e(t)("Disconnect")),1)]),_:1})])]),default:a(()=>[c("div",Oe,[o(N,{direction:"vertical",column:1,border:""},{default:a(()=>[o(D,{label:e(t)("Recording")},{default:a(()=>[w(r(e(s).status.recording?e(t)("Yes"):e(t)("No")),1)]),_:1},8,["label"]),o(D,{label:e(t)("Output Path")},{default:a(()=>[w(r(e(s).status.outputPath||e(t)("None")),1)]),_:1},8,["label"])]),_:1})]),c("div",Ue,[o(v,{disabled:!e(s).status.connected||e(s).status.recording,type:"primary",onClick:n[4]||(n[4]=l=>e(s).startRecord())},{default:a(()=>[w(r(e(t)("Start Record")),1)]),_:1},8,["disabled"]),o(v,{disabled:!e(s).status.connected||!e(s).status.recording,type:"danger",onClick:n[5]||(n[5]=l=>e(s).stopRecord())},{default:a(()=>[w(r(e(t)("Stop Record")),1)]),_:1},8,["disabled"]),o(v,{disabled:!e(s).status.connected||!e(s).status.recording,type:"warning",onClick:n[6]||(n[6]=l=>e(s).splitRecord())},{default:a(()=>[w(r(e(t)("Split Record")),1)]),_:1},8,["disabled"])])]),_:1}),o(U,{class:"instruction-alert",type:"info",description:e(t)("hideTutorial"),closable:!1,"show-icon":""},null,8,["description"]),o(B,{class:"table-card"},{header:a(()=>[c("div",ke,[c("span",null,r(e(t)("User Content Settings")),1)])]),default:a(()=>[o(Z,{data:e(u),style:{width:"100%"},border:!0,stripe:""},{default:a(()=>[o(m,{prop:"type",label:e(t)("Type"),"min-width":"120"},{default:a(l=>[c("span",null,r(e(t)(l.row.type)),1)]),_:1},8,["label"]),o(m,{label:e(t)("Start When"),align:"center"},{default:a(()=>[o(m,{prop:"enter",label:e(t)("Enter Zone"),align:"center",width:"100"},{default:a(l=>[o(V,{modelValue:l.row.enter,"onUpdate:modelValue":f=>l.row.enter=f},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),o(m,{prop:"countdown",label:e(t)("CountDown"),align:"center",width:"100"},{default:a(l=>[o(V,{modelValue:l.row.countdown,"onUpdate:modelValue":f=>l.row.countdown=f},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),o(m,{prop:"combat",label:e(t)("InCombat"),align:"center",width:"100"},{default:a(l=>[o(V,{modelValue:l.row.combat,"onUpdate:modelValue":f=>l.row.combat=f},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),o(m,{label:e(t)("End When"),align:"center"},{default:a(()=>[o(m,{prop:"leave",label:e(t)("Leave Zone"),align:"center",width:"100"},{default:a(l=>[o(V,{modelValue:l.row.leave,"onUpdate:modelValue":f=>l.row.leave=f},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),o(m,{prop:"wipe",label:e(t)("Wipe"),align:"center",width:"100"},{default:a(l=>[o(V,{modelValue:l.row.wipe,"onUpdate:modelValue":f=>l.row.wipe=f},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})])):(y(),X(B,{key:0,class:"connection-card"},{header:a(()=>[c("div",Ee,[c("span",null,r(e(t)("Connect to OBS")),1)])]),default:a(()=>[o(z,{"label-position":"top",class:"connection-form"},{default:a(()=>[o(b,{label:e(t)("Port")},{default:a(()=>[o(p,{modelValue:e(d).host,"onUpdate:modelValue":n[0]||(n[0]=l=>e(d).host=l),placeholder:e(t)("portPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(b,{label:e(t)("Password")},{default:a(()=>[o(p,{modelValue:e(d).password,"onUpdate:modelValue":n[1]||(n[1]=l=>e(d).password=l),placeholder:e(t)("passwordPlaceholder"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(b,null,{default:a(()=>[o(v,{type:"primary",class:"connect-button",loading:e(s).status.connecting,disabled:e(s).status.connecting||!e(d).host||!e(d).password,onClick:n[2]||(n[2]=l=>e(s).connect())},{default:a(()=>[w(r(e(s).status.connecting?e(t)("Connecting..."):e(t)("Connect")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),o(F,null,{default:a(()=>[w(r(e(t)("Instructions")),1)]),_:1}),o(U,{class:"instruction-alert",type:"info",description:e(t)("overlayTutorial"),closable:!1,"show-icon":""},null,8,["description"]),o(U,{class:"instruction-alert",type:"info",description:e(t)("obsTutorial"),closable:!1,"show-icon":""},null,8,["description"]),o(U,{class:"instruction-alert",type:"info",description:e(t)("inputTutorial"),closable:!1,"show-icon":""},null,8,["description"])]),_:1}))])])}}});const Le=A(Be,[["__scopeId","data-v-1a8b5b31"]]);export{Le as default};
