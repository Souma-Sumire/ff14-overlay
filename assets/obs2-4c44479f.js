import{az as N,q as B,Y as M,b as F,o as h,e as k,t as c,a as o,w as s,F as Y,L as J,u as e,c as x,a1 as K,ad as Q,a2 as X,G as ee,H as te,d as ne,n as $,aA as oe,y as r,a0 as P,x as w,aB as S,aC as se,J as ae,ah as le,B as ce,ak as ie,N as re,al as de,aD as ue,aE as pe,as as _e,ap as me,af as he,C as fe,ag as be}from"./vendor-8bdaa26a.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";import{C as A}from"./content_type-52b79aff.js";import{a as we,r as ge,c as ve}from"./overlay_plugin_api-409cb9ea.js";import{z as ye}from"./zoneInfo-a419d684.js";const Ce=V=>(ee("data-v-179b86b4"),V=V(),te(),V),Se={class:"language-switcher"},Ve={class:"select-wrapper"},Re=Ce(()=>c("svg",{class:"globe-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[c("circle",{cx:"12",cy:"12",r:"10"}),c("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),c("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})],-1)),Ee={__name:"LanguageSwitcher",setup(V){const{locale:t,availableLocales:d}=N(),_={zhCn:"简体中文",en:"English",ja:"日本語"},f=B("user-locale",t.value);return M(f,g=>{t.value=g}),F(()=>{t.value=f.value}),(g,T)=>{const O=Q,v=X;return h(),k("div",Se,[c("div",Ve,[Re,o(v,{modelValue:e(f),"onUpdate:modelValue":T[0]||(T[0]=y=>K(f)?f.value=y:null),size:"small",class:"language-select"},{default:s(()=>[(h(!0),k(Y,null,J(e(d),(y,D)=>(h(),x(O,{key:D,value:y,label:_[y]},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])])}}},ke=W(Ee,[["__scopeId","data-v-179b86b4"]]),Te={class:"obs-container"},Oe={class:"card-header"},Ue={class:"act-not-ready-content"},Be={key:1},xe={class:"card-header"},De={key:1},Ie={class:"card-header"},Pe={class:"status-info"},Ae={class:"button-container"},Le={class:"card-header"},ze=ne({__name:"obs2",setup(V){const{t}=N(),d=B("obs-user-config",{host:4455,password:""}),_=B("obs-user-content-setting",[]),f=B("obs-is-first-time",!0),g=$(!1),T=$(!1);function O(){return new Promise(p=>{ve({call:"cactbotRequestState"}).then(()=>{g.value=!0,p()}),setTimeout(()=>{g.value||O()},3e3)})}const v=["Raids","UltimateRaids","Dungeons","Trials","VCDungeonFinder","DeepDungeons","Guildhests","DisciplesOfTheLand","Eureka","GrandCompany","QuestBattles","TreasureHunt","Pvp"];function y(){const p=["Raids","UltimateRaids"];if(f.value)f.value=!1,_.value=[...p.map(n=>({type:n,enter:!1,countdown:!0,combat:!1,leave:!0,wipe:!0})),...v.filter(n=>!p.includes(n)).map(n=>({type:n,enter:!1,countdown:!1,combat:!1,leave:!1,wipe:!1}))];else{_.value=_.value.filter(i=>v.includes(i.type));const n=v.filter(i=>!_.value.some(u=>u.type===i)).map(i=>p.includes(i)?{type:i,enter:!1,countdown:!0,combat:!1,leave:!0,wipe:!0}:{type:i,enter:!1,countdown:!1,combat:!1,leave:!1,wipe:!1});_.value.push(...n)}_.value.sort((n,i)=>v.indexOf(n.type)-v.indexOf(i.type))}class D{constructor(){this.handleConnectionError=()=>{this.status.connecting=!1,this.status.connected=!1,this.status.recording=!1,this.status.outputActive=!1,this.status.outputPath="",S.modal.close(),S.modal.message({title:t("OBS Connection"),content:t("OBS Connection Error"),status:"warning",duration:2e3})},this.handleConnectionClosed=()=>{this.status.connecting=!1,this.status.connected=!1,this.status.recording=!1,this.status.outputActive=!1,this.status.outputPath="",S.modal.close(),S.modal.message({title:t("OBS Connection"),content:t("OBS Connection Closed"),status:"warning",duration:2e3})},this.ws=new se,this.status=ae({connecting:!1,connected:!1,recording:!1,outputActive:!1,outputPath:""}),this.ws.on("ConnectionClosed",this.handleConnectionClosed),this.ws.on("ConnectionError",this.handleConnectionError),this.ws.on("RecordStateChanged",n=>{this.status.connected=!0,this.status.recording=n.outputState==="OBS_WEBSOCKET_OUTPUT_STARTED",this.status.outputActive=n.outputActive,this.status.outputPath=n.outputPath})}connect(){d.value.host&&d.value.password&&(this.status.connecting=!0,this.ws.connect(`ws://127.0.0.1:${d.value.host}`,d.value.password).then(()=>{this.ws.call("GetRecordStatus").then(n=>{this.status.recording=n.outputActive,this.status.outputActive=n.outputActive}),this.status.connected=!0,S.modal.close(),S.modal.message({title:t("OBS Connection"),content:t("OBS Connection Opened"),status:"success",duration:2e3})}).finally(()=>{this.status.connecting=!1}))}disconnect(){this.ws.disconnect()}startRecord(){this.ws.call("StartRecord")}stopRecord(){this.ws.call("StopRecord")}splitRecord(){this.ws.call("StopRecord").finally(()=>{setTimeout(()=>{this.ws.call("StartRecord")},1e3)})}}const l=new D,L=p=>{var u;const n=p.zoneID,i=(u=ye[n])==null?void 0:u.contentType;for(const C in A)if(Object.prototype.hasOwnProperty.call(A,C)&&A[C]===i){Z(C,"enter");return}};function Z(p,n){const i=l.status.recording;if(_.value.find(u=>u.type===p&&u[n]))switch(n){case"enter":case"countdown":case"combat":i?l.splitRecord():l.startRecord();return;case"leave":case"wipe":i&&l.stopRecord()}}return F(async()=>{await O(),l.connect(),we("ChangeZone",L),y()}),oe(()=>{l.disconnect(),ge("ChangeZone",L)}),(p,n)=>{const i=ke,u=le,C=ce,U=ie,R=re,j=de,G=ue,I=pe,z=_e,H=me,b=he,E=fe,q=be;return h(),k("div",Te,[c("header",null,[c("h1",null,r(e(t)("OBS Auto Record V2")),1),o(i)]),e(g)?P("",!0):(h(),x(u,{key:0,class:"act-not-ready-card"},{header:s(()=>[c("div",Oe,[c("span",null,r(e(t)("ACT Not Ready")),1)])]),default:s(()=>[c("div",Ue,[c("p",null,r(e(t)("overlayTutorial")),1)])]),_:1})),e(g)?(h(),k("main",Be,[e(l).status.connected?(h(),k("div",De,[e(T)?(h(),x(u,{key:0,class:"status-card"},{header:s(()=>[c("div",Ie,[c("span",null,r(e(t)("Connection Status")),1),o(R,{type:"danger",size:"small",class:"disconnect-button",onClick:n[3]||(n[3]=a=>e(l).disconnect())},{default:s(()=>[w(r(e(t)("Disconnect")),1)]),_:1})])]),default:s(()=>[c("div",Pe,[o(H,{direction:"vertical",column:1,border:""},{default:s(()=>[o(z,{label:e(t)("Recording")},{default:s(()=>[w(r(e(l).status.recording?e(t)("Yes"):e(t)("No")),1)]),_:1},8,["label"]),o(z,{label:e(t)("Output Path")},{default:s(()=>[w(r(e(l).status.outputPath||e(t)("None")),1)]),_:1},8,["label"])]),_:1})]),c("div",Ae,[o(R,{disabled:!e(l).status.connected||e(l).status.recording,type:"primary",onClick:n[4]||(n[4]=a=>e(l).startRecord())},{default:s(()=>[w(r(e(t)("Start Record")),1)]),_:1},8,["disabled"]),o(R,{disabled:!e(l).status.connected||!e(l).status.recording,type:"danger",onClick:n[5]||(n[5]=a=>e(l).stopRecord())},{default:s(()=>[w(r(e(t)("Stop Record")),1)]),_:1},8,["disabled"]),o(R,{disabled:!e(l).status.connected||!e(l).status.recording,type:"warning",onClick:n[6]||(n[6]=a=>e(l).splitRecord())},{default:s(()=>[w(r(e(t)("Split Record")),1)]),_:1},8,["disabled"])])]),_:1})):P("",!0),o(u,{class:"table-card"},{header:s(()=>[c("div",Le,[c("span",null,r(e(t)("User Content Settings")),1)])]),default:s(()=>[o(q,{data:e(_),style:{width:"100%"},border:!0,stripe:""},{default:s(()=>[o(b,{prop:"type",label:e(t)("Type"),"min-width":"120"},{default:s(a=>[c("span",null,r(e(t)(a.row.type)),1)]),_:1},8,["label"]),o(b,{label:e(t)("Start When"),align:"center"},{default:s(()=>[o(b,{prop:"enter",label:e(t)("Enter Zone"),align:"center",width:"100"},{default:s(a=>[o(E,{modelValue:a.row.enter,"onUpdate:modelValue":m=>a.row.enter=m},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),o(b,{prop:"countdown",label:e(t)("CountDown"),align:"center",width:"100"},{default:s(a=>[o(E,{modelValue:a.row.countdown,"onUpdate:modelValue":m=>a.row.countdown=m},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),o(b,{prop:"combat",label:e(t)("InCombat"),align:"center",width:"100"},{default:s(a=>[o(E,{modelValue:a.row.combat,"onUpdate:modelValue":m=>a.row.combat=m},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),o(b,{label:e(t)("End When"),align:"center"},{default:s(()=>[o(b,{prop:"leave",label:e(t)("Leave Zone"),align:"center",width:"100"},{default:s(a=>[o(E,{modelValue:a.row.leave,"onUpdate:modelValue":m=>a.row.leave=m},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),o(b,{prop:"wipe",label:e(t)("Wipe"),align:"center",width:"100"},{default:s(a=>[o(E,{modelValue:a.row.wipe,"onUpdate:modelValue":m=>a.row.wipe=m},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1}),o(I,{class:"instruction-alert",type:"info",description:e(t)("hideTutorial"),closable:!1,"show-icon":""},null,8,["description"])])):(h(),x(u,{key:0,class:"connection-card"},{header:s(()=>[c("div",xe,[c("span",null,r(e(t)("Connect to OBS")),1)])]),default:s(()=>[o(j,{"label-position":"top",class:"connection-form"},{default:s(()=>[o(U,{label:e(t)("Port")},{default:s(()=>[o(C,{modelValue:e(d).host,"onUpdate:modelValue":n[0]||(n[0]=a=>e(d).host=a),placeholder:e(t)("portPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(U,{label:e(t)("Password")},{default:s(()=>[o(C,{modelValue:e(d).password,"onUpdate:modelValue":n[1]||(n[1]=a=>e(d).password=a),placeholder:e(t)("passwordPlaceholder"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(U,null,{default:s(()=>[o(R,{type:"primary",class:"connect-button",loading:e(l).status.connecting,disabled:e(l).status.connecting||!e(d).host||!e(d).password,onClick:n[2]||(n[2]=a=>e(l).connect())},{default:s(()=>[w(r(e(l).status.connecting?e(t)("Connecting"):e(t)("Connect")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),o(G,null,{default:s(()=>[w(r(e(t)("Instructions")),1)]),_:1}),o(I,{class:"instruction-alert",type:"info",description:e(t)("obsTutorial"),closable:!1,"show-icon":""},null,8,["description"]),o(I,{class:"instruction-alert",type:"info",description:e(t)("inputTutorial"),closable:!1,"show-icon":""},null,8,["description"])]),_:1}))])):P("",!0)])}}});const je=W(ze,[["__scopeId","data-v-3b9a1299"]]);export{je as default};
