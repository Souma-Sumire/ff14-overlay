import{d as Y,s as j,v as U,x as S,y as q,A as s,B as G,C as H,o as c,b as v,f as a,D as J,F as K,u as e,G as u,a as r,w as b,H as E,I as Q,c as T,t as B,J as R,K as Z,L as ll,M as el,N as tl,O as ol,p as nl,j as al,P as sl,Q as ul}from"./vendor-d54c40a3.js";import{a as y,r as g}from"./overlay_plugin_api-409cb9ea.js";import{_ as rl}from"./index-43efde23.js";const I=f=>(nl("data-v-8e7f7ab8"),f=f(),al(),f),dl={class:"dnc-overlay"},ml={class:"settings"},il=I(()=>a("br",null,null,-1)),pl=I(()=>a("br",null,null,-1)),fl=Y({__name:"dnc",setup(f){var x,_;j(n=>({"8a0cd4b6":e(F),"4f9b068e":e(h),"839159de":e(D),"2398cb32":e(L),"6748e2da":e(M),"7f5edd4b":e(P),f13aef90:e($)}));const p=U(0),d=S({playerId:"",lastCombo:0,status:new Map([["A85",0],["A86",0],["BC9",0],["BCA",0]])}),l=q("jobs-dnc",{combo:{left:10,top:-30},tr3:{left:46,top:-22},tr4:{left:82,top:-22},fl:{left:0,top:-15},color:"rgb(255,255,255)",shadow:"rgb(0,0,0)",size:14,warncolor:"rgb(255,255,255)",warnshadow:"rgb(255,0,0)",zeroStr:"",fontFamily:"微软雅黑",fontWeight:!1,warn:5,userCss:""},localStorage,{mergeDefaults:!0}),V=U(((_=(x=document.getElementById("unlocked"))==null?void 0:x.style)==null?void 0:_.display)==="flex"),A=S([{id:"combo",cd:s(()=>30-Math.floor((p.value-d.lastCombo)/1e3)),style:{top:s(()=>`${l.value.combo.top}px`),left:s(()=>`${l.value.combo.left}px`)}},{id:"tr3",cd:s(()=>30-Math.floor((p.value-(d.status.get("A85")??0))/1e3)),style:{top:s(()=>`${l.value.tr3.top}px`),left:s(()=>`${l.value.tr3.left}px`)}},{id:"tr4",cd:s(()=>30-Math.floor((p.value-(d.status.get("A86")??0))/1e3)),style:{top:s(()=>`${l.value.tr4.top}px`),left:s(()=>`${l.value.tr4.left}px`)}},{id:"fl3",cd:s(()=>30-Math.floor((p.value-(d.status.get("BC9")??0))/1e3)),style:{top:s(()=>`${l.value.tr3.top+l.value.fl.top}px`),left:s(()=>`${l.value.tr3.left+l.value.fl.left}px`)}},{id:"fl4",cd:s(()=>30-Math.floor((p.value-(d.status.get("BCA")??0))/1e3)),style:{top:s(()=>`${l.value.tr4.top+l.value.fl.top}px`),left:s(()=>`${l.value.tr4.left+l.value.fl.left}px`)}}]),D=s(()=>l.value.color),L=s(()=>l.value.shadow),P=s(()=>l.value.warncolor),$=s(()=>l.value.warnshadow),F=s(()=>l.value.fontFamily),M=s(()=>`${l.value.size}px`),h=s(()=>l.value.fontWeight?"bold":"none"),k=s(()=>l.value.userCss),w=n=>{n.line[5]===d.playerId&&(n.line[0]==="26"||n.line[0]==="30")&&d.status.has(n.line[2])?d.status.set(n.line[2],n.line[0]==="26"?Date.now():0):n.line[2]===d.playerId&&(n.line[0]==="21"||n.line[0]==="22")&&(n.line[4]==="3E79"&&n.line[0]==="22"||n.line[4]==="3E75"&&n.line[0]==="21"?d.lastCombo=Date.now():(n.line[4]==="3E76"||n.line[4]==="3E7A"||n.line[0]==="21"&&n.line[4]==="3E79")&&(d.lastCombo=0))};function z(){d.status.set("A85",0),d.status.set("A86",0),d.status.set("BC9",0),d.status.set("BCA",0),d.lastCombo=0}const C=n=>{d.playerId=Number(n.charID).toString(16).toUpperCase()};function N(){localStorage.removeItem("jobs-dnc"),location.reload()}return G(()=>{y("onPlayerDied",z),y("LogLine",w),y("ChangePrimaryPlayer",C),startOverlayEvents(),document.addEventListener("onOverlayStateUpdate",n=>{var o;V.value=((o=n==null?void 0:n.detail)==null?void 0:o.isLocked)===!1})}),H(()=>{g("onPlayerDied",z),g("LogLine",w),g("ChangePrimaryPlayer",C)}),requestAnimationFrame(function n(){p.value=Date.now(),requestAnimationFrame(n)}),(n,o)=>{const m=Z,i=ll,O=el,W=tl,X=ol;return c(),v(E,null,[a("div",dl,[J(a("header",ml,[a("form",null,[u(" 连击X: "),r(m,{class:"input input-number",modelValue:e(l).combo.left,"onUpdate:modelValue":o[0]||(o[0]=t=>e(l).combo.left=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 连击Y: "),r(m,{class:"input input-number",modelValue:e(l).combo.top,"onUpdate:modelValue":o[1]||(o[1]=t=>e(l).combo.top=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 触发3X: "),r(m,{class:"input input-number",modelValue:e(l).tr3.left,"onUpdate:modelValue":o[2]||(o[2]=t=>e(l).tr3.left=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 触发3Y: "),r(m,{class:"input input-number",modelValue:e(l).tr3.top,"onUpdate:modelValue":o[3]||(o[3]=t=>e(l).tr3.top=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 触发4X: "),r(m,{class:"input input-number",modelValue:e(l).tr4.left,"onUpdate:modelValue":o[4]||(o[4]=t=>e(l).tr4.left=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 触发4Y: "),r(m,{class:"input input-number",modelValue:e(l).tr4.top,"onUpdate:modelValue":o[5]||(o[5]=t=>e(l).tr4.top=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 百花X: "),r(m,{class:"input input-number",modelValue:e(l).fl.left,"onUpdate:modelValue":o[6]||(o[6]=t=>e(l).fl.left=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 百花Y: "),r(m,{class:"input input-number",modelValue:e(l).fl.top,"onUpdate:modelValue":o[7]||(o[7]=t=>e(l).fl.top=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 剩余警告: "),r(m,{class:"input input-number",min:-1,max:30,modelValue:e(l).warn,"onUpdate:modelValue":o[8]||(o[8]=t=>e(l).warn=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 常规颜色: "),r(i,{class:"input input-string",modelValue:e(l).color,"onUpdate:modelValue":o[9]||(o[9]=t=>e(l).color=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 常规阴影: "),r(i,{class:"input input-string",modelValue:e(l).shadow,"onUpdate:modelValue":o[10]||(o[10]=t=>e(l).shadow=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 警告颜色: "),r(i,{class:"input input-string",modelValue:e(l).warncolor,"onUpdate:modelValue":o[11]||(o[11]=t=>e(l).warncolor=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 警告阴影: "),r(i,{class:"input input-string",modelValue:e(l).warnshadow,"onUpdate:modelValue":o[12]||(o[12]=t=>e(l).warnshadow=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 零值文本: "),r(i,{class:"input input-string",modelValue:e(l).zeroStr,"onUpdate:modelValue":o[13]||(o[13]=t=>e(l).zeroStr=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 字号: "),r(m,{class:"input input-number",modelValue:e(l).size,"onUpdate:modelValue":o[14]||(o[14]=t=>e(l).size=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 字体: "),r(i,{class:"input input-string",modelValue:e(l).fontFamily,"onUpdate:modelValue":o[15]||(o[15]=t=>e(l).fontFamily=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 粗体："),r(O,{modelValue:e(l).fontWeight,"onUpdate:modelValue":o[16]||(o[16]=t=>e(l).fontWeight=t),size:"small"},null,8,["modelValue"])]),a("form",null,[u(" 自定义CSS： "),il,r(i,{modelValue:e(l).userCss,"onUpdate:modelValue":o[17]||(o[17]=t=>e(l).userCss=t),autosize:"",type:"textarea",placeholder:""},null,8,["modelValue"])]),pl,a("form",null,[r(X,{onConfirm:N,teleported:!1,title:"确定要重置？"},{reference:b(()=>[r(W,null,{default:b(()=>[u("重置全部用户设置")]),_:1})]),_:1})])],512),[[K,e(V)]]),a("main",null,[(c(!0),v(E,null,Q(e(A),t=>(c(),v("div",{key:t.id},[a("span",{class:sl(t.cd<=e(l).warn&&!e(V)?"warning":""),style:ul(t.style)},B(t.cd>=0?t.cd:e(V)?"30":e(l).zeroStr),7)]))),128))])]),(c(),T(R("style"),null,{default:b(()=>[u(B(e(k)),1)]),_:1}))],64)}}});const bl=rl(fl,[["__scopeId","data-v-8e7f7ab8"]]);export{bl as default};
