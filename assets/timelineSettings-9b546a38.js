import{d as me,n as N,J as xe,o as C,e as R,a as t,w as l,u as i,a1 as L,x as b,y as J,t as f,s as de,v as ce,F as H,L as Q,ai as h,aj as oe,B as Ve,ak as Ce,C as We,N as Se,al as $e,af as Ie,ag as Ee,ae as pe,a2 as ke,am as fe,c as A,ad as Be,Z as Ge,p as ue,an as Ae,ao as Ze,G as Ne,H as De,A as Ye,_ as Te,ap as Xe,b as et,Y as tt,a0 as se,W as nt,aq as Fe,ar as it,U as ae,T as lt,as as ot,a4 as st,a3 as at,D as rt,ah as dt,at as ct,a5 as ut,a6 as mt}from"./vendor-688a9a69.js";import{u as _e,_ as Ue,p as pt}from"./TimelineShow-28dd63e2.js";import{U as M}from"./util-831b56e7.js";import{g as ft}from"./actionChinese-f29d4188.js";import{g as _t,h as gt}from"./xivapi-a5c0f7f0.js";import{_ as ge}from"./_plugin-vue_export-helper-c27b6911.js";import{a as yt,c as wt}from"./overlay_plugin_api-409cb9ea.js";import{z as re}from"./zoneInfo-9e4e9a78.js";import{r as bt}from"./index-d4cdb287.js";import{u as ht}from"./useWebSocket-7db45fbf.js";import"./actWS-e2500b62.js";const a=new Map;a.set(26155,{type:"cast",window:[999,999]});a.set(28027,{type:"cast",window:[999,999]});a.set(26340,{type:"cast",window:[999,999]});a.set(25533,{type:"begincast",window:[60,60]});a.set(26376,{type:"cast",window:[999,999]});a.set(26814,{type:"begincast",window:[999,999]});a.set(25313,{type:"begincast",window:[200,200]});a.set(27526,{type:"begincast",window:[999,999]});a.set(26215,{type:"cast",window:[500,30]});a.set(29050,{type:"begincast",window:[200,30]});a.set(29156,{type:"cast",window:[20,20]});a.set(27973,{type:"cast",window:[20,20]});a.set(27937,{type:"begincast",window:[20,20]});a.set(28059,{type:"begincast",window:[20,20]});a.set(28060,{type:"begincast",window:[20,20]});a.set(28061,{type:"begincast",window:[20,20]});a.set(27956,{type:"begincast",window:[20,20]});a.set(27957,{type:"begincast",window:[20,20]});a.set(27952,{type:"begincast",window:[30,30]});a.set(27969,{type:"begincast",window:[20,20]});a.set(27971,{type:"begincast",window:[20,20]});a.set(27939,{type:"begincast",window:[20,20]});a.set(27966,{type:"begincast",window:[20,20]});a.set(25316,{type:"begincast",window:[999,999]});a.set(25544,{type:"begincast",window:[10,10]});a.set(26379,{type:"begincast",window:[10,10]});a.set(31552,{type:"begincast",window:[30,30]});a.set(31573,{type:"begincast",window:[30,30]});a.set(31573,{type:"begincast",window:[30,30]});a.set(31617,{type:"begincast",window:[8,8]});a.set(31624,{type:"begincast",window:[30,30]});a.set(31649,{type:"begincast",window:[30,30]});a.set(18864,{type:"cast",window:[10,2.5],once:!0});a.set(18480,{type:"cast",window:[200,60],once:!0});a.set(18516,{type:"cast",window:[250,65],once:!0});a.set(18522,{type:"begincast",window:[500,500],once:!0});a.set(18552,{type:"begincast",window:[67,67],once:!0});a.set(18553,{type:"cast",window:[67,67],once:!0});a.set(19083,{type:"cast",window:[900,0],once:!0});function vt(x){const k=new Map;x.filter(p=>p.type==="begincast").map(p=>k.set(p.actionId,(k.get(p.actionId)??0)+1));for(const p of x){k.get(p.actionId)===1&&p.type==="begincast"&&(p.window=[12,12]);const r=a.get(p.actionId);(r==null?void 0:r.type)===p.type&&(p.window=r==null?void 0:r.window),p.syncOnce=!!(r!=null&&r.once)}return x}const Tt={class:"fflogs-query-result-friendlies"},Ft=["src","onerror"],xt=me({__name:"FflogsImport",props:{filters:{}},emits:["newTimeline","showFFlogsToggle","clearCurrentlyTimeline","updateFilters"],setup(x,{emit:k}){const p=x,r=k,w=new RegExp("(?<=^|\\/)(?<code>\\w{16,})\\/?#fight=(?<fight>\\d+|last)"),O={begincast:"14",cast:"1[56]"},F=N("查询"),$=N(""),I=N(!1),e=xe({});q();const S=_e();function j(V){var _;h.fire({text:"正在解析数据 (步骤1/3)",showConfirmButton:!1}),q(),F.value="正在请求";const d=V.match(w);S.settings.api?d?d?(e.code=((_=d.groups)==null?void 0:_.code)??"",oe.get(`https://cn.fflogs.com/v1/report/fights/${e.code}?api_key=${S.settings.api}`).then(m=>{var y,v;e.bossIDs=m.data.enemies.filter(s=>s.type==="Boss").map(s=>s.id),e.fightIndex=(((y=d==null?void 0:d.groups)==null?void 0:y.fight)==="last"?m.data.fights.length:Number.parseInt(((v=d==null?void 0:d.groups)==null?void 0:v.fight)??"0"))-1;const u=m.data.fights[e.fightIndex];e.zoneID=u.zoneID,e.start=u.start_time,e.end=u.end_time,e.friendlies=m.data.friendlies.filter(s=>s.icon!=="LimitBreak"&&s.fights.find(P=>P.id===e.fightIndex+1)),F.value="查询",e.abilityFilterEvents.length=0,e.abilityFilterCandidate.length=0,h.fire("在列表中选择一名玩家")}).catch(m=>{h.fire({icon:"error",title:"Oops...(步骤1)",text:m}),F.value="查询"})):(h.fire({icon:"error",title:"url链接格式错误",footer:`验证规则：${w.toString().replaceAll(/\?<\w+>/g,"")}`}),F.value="查询"):(h.fire({icon:"error",title:"FF logs 战斗记录链接 未填写",footer:"例如：aaAAAAaAAAaAaa11#fight=18"}),F.value="查询"):(h.fire({icon:"error",title:"FF logs API Key 未填写",footer:'<a href="https://cn.fflogs.com/profile">点击这里，在最下方起名，然后获得你的V1 Client Key</a>'}),F.value="查询")}async function U(V){e.player=V,await B().then(()=>{e.abilityFilterCandidate=e.abilityFilterEvents.reduce((d,_)=>(_.sourceIsFriendly&&!d.find(m=>m.actionId===_.actionId)&&d.push(_),d),[])}).catch(d=>{h.fire({icon:"error",title:"Oops...(步骤2)",text:d})})}async function B(){h.fire({text:"正在解析数据，请耐心等待。(步骤2/3)",showConfirmButton:!1});const V=[];e.abilityFilterEvents.length=0;async function d(y){var v;await oe.get(`https://cn.fflogs.com/v1/report/events/casts/${e.code}?start=${y}&end=${e.end}&hostility=0&sourceid=${(v=e.player)==null?void 0:v.id}&api_key=${S.settings.api}`).then(async s=>{V.push(...s.data.events),s.data.nextPageTimestamp&&s.data.nextPageTimestamp>0&&s.data.nextPageTimestamp<e.end&&await d(s.data.nextPageTimestamp)}).catch(s=>{h.fire({icon:"error",title:"Oops...(步骤3.1)",text:s})})}async function _(y,v){v>=0&&await oe.get(`https://cn.fflogs.com/v1/report/events/casts/${e.code}?start=${y}&end=${e.end}&hostility=1&sourceid=${e.bossIDs[v]}&api_key=${S.settings.api}`).then(async s=>{V.push(...s.data.events),s.data.nextPageTimestamp&&s.data.nextPageTimestamp>0&&s.data.nextPageTimestamp<e.end&&await _(s.data.nextPageTimestamp,v),v<e.bossIDs.length-1&&await _(y,v+1)}).catch(s=>{h.fire({icon:"error",title:"Oops...(步骤3.2)",text:s})})}const m=await d(e.start),u=await _(e.start,0);await Promise.all([m,u]).then(()=>{var y,v;for(const s of V)s.type==="begincast"&&s.sourceIsFriendly||e.abilityFilterEvents.push({time:Number(((s.timestamp-e.start)/1e3).toFixed(1)),type:s.type,actionName:ft(s.ability.guid)??s.ability.name,actionId:s.ability.guid,sourceIsFriendly:s.sourceIsFriendly,url:((y=s==null?void 0:s.ability)==null?void 0:y.abilityIcon.replace("-","/").replace(".png",""))??"000000/000405",window:void 0});(v=e.player)!=null&&v.icon&&p.filters[e.player.icon]&&(e.abilityFilterSelected=p.filters[e.player.icon]),h.fire("请在技能过滤器中选择需要的技能")})}function K(){var V,d,_,m;h.fire({text:"正在解析数据 (步骤3/3)",showConfirmButton:!1}),(V=e.player)!=null&&V.icon&&r("updateFilters",(d=e.player)==null?void 0:d.icon,JSON.parse(JSON.stringify(e.abilityFilterSelected))),e.abilityFilterEvents=e.abilityFilterEvents.filter(u=>u.sourceIsFriendly&&e.abilityFilterSelected.includes(u.actionId)||!u.sourceIsFriendly).sort((u,y)=>u.time-y.time),e.abilityFilterEvents=vt(e.abilityFilterEvents),e.abilityFilterEventsAfterFilterRawTimeline=e.abilityFilterEvents.map(u=>u.sourceIsFriendly?`${u.time} "<${u.actionName}>~"${I.value?` tts "${u.actionName}"`:""}`:/^(?:攻击|attack|攻撃)$|^unknown/i.test(u.actionName)||u.type==="cast"&&u.window===void 0?`# ${u.time} "${u.actionName}"`:`${u.time} "${u.actionName}" sync /^.{14} \\w+ ${O[u.type]}:4.{7}:[^:]+:${u.actionId.toString(16).toUpperCase()}:/${u.window?` window ${u.window.join(",")}`:""}`).join(`
`),r("newTimeline",`导入${(_=e.player)==null?void 0:_.name}`,{zoneId:e.zoneID.toString(),job:((m=e.player)==null?void 0:m.icon)??"NONE"},e.abilityFilterEventsAfterFilterRawTimeline,`${e.code}#fight=${e.fightIndex+1}`),q(),r("showFFlogsToggle"),h.fire({position:"top-end",icon:"success",title:"已生成新时间轴",showConfirmButton:!1,timer:1500})}function q(){e.code="",e.fightIndex=0,e.start=0,e.end=0,e.friendlies=[],e.abilityFilterEvents=[],e.abilityFilterCandidate=[],e.abilityFilterSelected=[],e.abilityFilterEventsAfterFilterRawTimeline="",e.player=void 0,e.zoneID=0,e.bossIDs=[]}return(V,d)=>{const _=Ve,m=Ce,u=We,y=Se,v=$e,s=Ie,P=Ee,W=pe,te=Be,ne=ke,G=fe;return C(),R(H,null,[t(v,{inline:!0,class:"fflogs-query"},{default:l(()=>[t(m,{label:"FF logs 战斗",style:{width:"450px"}},{default:l(()=>[t(_,{modelValue:i($),"onUpdate:modelValue":d[0]||(d[0]=g=>L($)?$.value=g:null),placeholder:"reports/AAAaAaAAaa1aA1aA#fight=3",autocomplete:"on"},null,8,["modelValue"])]),_:1}),t(m,{label:"FF logs V1 Key",style:{width:"450px"}},{default:l(()=>[t(_,{modelValue:i(S).settings.api,"onUpdate:modelValue":d[1]||(d[1]=g=>i(S).settings.api=g)},null,8,["modelValue"])]),_:1}),t(m,{label:"添加TTS",style:{width:"100px"}},{default:l(()=>[t(u,{modelValue:i(I),"onUpdate:modelValue":d[2]||(d[2]=g=>L(I)?I.value=g:null)},null,8,["modelValue"])]),_:1}),t(m,null,{default:l(()=>[t(y,{disabled:i(F)==="正在请求",type:"primary",onClick:d[3]||(d[3]=g=>j(i($)))},{default:l(()=>[b(J(i(F)),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),f("div",Tt,[t(W,null,{default:l(()=>[de(t(P,{data:i(e).friendlies.filter(g=>g.icon!=="NPC"),stripe:"",border:"",class:"fflogs-query-result-friendlies-list"},{default:l(()=>[t(s,{prop:"name",label:"玩家名称","min-width":"60px"}),t(s,{prop:"server",label:"服务器","min-width":"60px"}),t(s,{label:"职业","min-width":"60px"},{default:l(({row:g})=>[b(J(i(M).nameToFullName(i(M).jobEnumToJob(i(M).iconToJobEnum(g.icon))).cn),1)]),_:1}),t(s,{label:"选定","min-width":"20px"},{default:l(g=>[t(y,{type:"primary",size:"small",onClick:ye=>U(g.row)},{default:l(()=>[b(" 选择 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),[[ce,i(e).abilityFilterEvents.length===0]])]),_:1}),de(t(W,{class:"fflogs-query-result-friendlies-ability-filter-select"},{default:l(()=>[t(G,{span:20},{default:l(()=>[t(ne,{modelValue:i(e).abilityFilterSelected,"onUpdate:modelValue":d[4]||(d[4]=g=>i(e).abilityFilterSelected=g),multiple:"",placeholder:"技能过滤器","fit-input-width":!0},{default:l(()=>[(C(!0),R(H,null,Q(i(e).abilityFilterCandidate,g=>(C(),A(te,{key:g.actionId,class:"ability-filter-li",value:g.actionId,label:g.actionName},{default:l(()=>[f("img",{src:i(_t)(`/i/${g.url}.png`),class:"ability-filter-li-icon",title:"",onerror:i(gt)},null,8,Ft),b(J(g.actionName),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(G,{span:4},{default:l(()=>[t(y,{type:"success",onClick:d[5]||(d[5]=g=>K())},{default:l(()=>[b(" 选择好了 ")]),_:1})]),_:1})]),_:1},512),[[ce,i(e).abilityFilterEvents.length>0]])])],64)}}});const Vt=ge(xt,[["__scopeId","data-v-b3c10a40"]]),ee=x=>(Ne("data-v-52d0d6b5"),x=x(),De(),x),Ct=ee(()=>f("h3",{style:{margin:"0",padding:"10px","background-color":"#f5f7fa",cursor:"move"}}," 设置 ",-1)),St=ee(()=>f("h3",{class:"form-section-title"}," 参数 ",-1)),$t=ee(()=>f("h3",{class:"form-section-title"}," 样式 ",-1)),It=ee(()=>f("h3",{class:"form-section-title"}," 测试用例 ",-1)),Et=me({__name:"SettingsDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(x,{emit:k}){const p=x,r=k,w=_e();Ge(()=>{w.saveTimelineSettings()});const O=ue({get:()=>p.modelValue,set:I=>r("update:modelValue",I)}),F=N(-15),$=N([{time:-15,action:"<圣光幕帘>~",show:!0},{time:-2,action:"<圣灵>~",show:!0},{time:0,action:"战斗开始！",show:!0},{time:3,action:"<挑衅>~",show:!0},{time:5,action:"<神圣领域>~",show:!0}]);return(I,e)=>{const S=Ye,j=Ce,U=fe,B=pe,K=Ae,q=Ue,V=$e,d=Ze;return C(),A(d,{modelValue:i(O),"onUpdate:modelValue":e[1]||(e[1]=_=>L(O)?O.value=_:null),modal:!0,overflow:"","close-on-click-modal":!1,"custom-class":"timeline-dialog",width:"600px","append-to-body":!0,draggable:!0},{header:l(()=>[Ct]),default:l(()=>[t(V,{"label-position":"right","label-width":"120px",class:"timeline-form"},{default:l(()=>[St,t(B,{gutter:20},{default:l(()=>[(C(!0),R(H,null,Q(i(w).configValues,(_,m,u)=>(C(),A(U,{key:u,span:12},{default:l(()=>[t(j,{label:i(w).configTranslate[m]},{default:l(()=>[t(S,{modelValue:i(w).configValues[m],"onUpdate:modelValue":y=>i(w).configValues[m]=y,min:0,step:.1,class:"custom-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1}),$t,t(B,{gutter:20},{default:l(()=>[(C(!0),R(H,null,Q(i(w).showStyle,(_,m,u)=>(C(),A(U,{key:u,span:12},{default:l(()=>[t(j,{label:i(w).showStyleTranslate[m]},{default:l(()=>[t(S,{modelValue:i(w).showStyle[m],"onUpdate:modelValue":y=>i(w).showStyle[m]=y,min:0,step:.01,class:"custom-input"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024))),128))]),_:1}),It,t(B,{gutter:20},{default:l(()=>[t(K,{modelValue:i(F),"onUpdate:modelValue":e[0]||(e[0]=_=>L(F)?F.value=_:null),min:-15,max:5,step:.1,"show-input":""},null,8,["modelValue"]),t(q,{config:i(w).configValues,lines:i($),runtime:i(F),"show-style":i(w).showStyle},null,8,["config","lines","runtime","show-style"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const kt=ge(Et,[["__scopeId","data-v-52d0d6b5"]]),D=x=>(Ne("data-v-a92a159c"),x=x(),De(),x),Bt=D(()=>f("br",null,null,-1)),At={class:"slider-demo-block"},Nt=D(()=>f("span",null,"模拟时间：",-1)),Dt={class:"timeline-info-config"},Ut=D(()=>f("span",null,"显示名称：",-1)),Ot={class:"timeline-info-config"},jt=D(()=>f("span",null,"限定地图：",-1)),qt={class:"timeline-info-config"},Pt=D(()=>f("span",null,"限定职业：",-1)),zt={class:"timeline-info-config"},Jt=D(()=>f("span",null,"战斗来源：",-1)),Mt={class:"timeline-info-config"},Rt=D(()=>f("span",null,"创建时间：",-1)),Lt={style:{flex:"1"}},Ht={style:{"max-height":"353px"}},Kt={class:"timeline-timeline-view"},Qt=D(()=>f("br",null,null,-1)),Wt=D(()=>f("br",null,null,-1)),Gt=me({__name:"timelineSettings",setup(x){const{wsConnected:k}=ht(),p=N(0),r=_e(),w=Te(r,"allTimelines"),O=Te(r,"filters"),F=[{id:"0",name:"任意"}],$=N(!1),I=N(!1),e=xe({timeline:{name:"空",condition:{zoneId:"0",job:"NONE"},timeline:"空",codeFight:"空",create:"空"}}),S=N([]);let j=null,U=!1;m();async function B(){S.value=[{time:0,action:"正在加载...",show:!0,windowBefore:0,windowAfter:0,alertAlready:!0}],S.value=await pt(e.timeline.timeline)}const K=Xe(ue(()=>M.getBattleJobs2()),500,{maxWait:5e3});q();function q(){var c,n,z;for(const E in re)if(Object.prototype.hasOwnProperty.call(re,E)){const T=re[E];switch(T.contentType){case 4:case 5:case 28:F.push({id:E,name:((c=T.name)==null?void 0:c.cn)??((n=T.name)==null?void 0:n.ja)??((z=T.name)==null?void 0:z.ja)??E})}}s(),r.sortTimelines()}function V(c,n={}){wt({call:"broadcast",source:"soumaTimelineSettings",msg:{type:c,data:n}})}function d(){$.value=!$.value,m()}function _(){const c="https://docs.qq.com/sheet/DTWxKT3lFbmpDV3Fm?tab=5ovrc8";window.open(c,"_blank")}function m(){p.value=-30,e.timeline={name:"空",condition:{zoneId:"0",job:"NONE"},timeline:"空",codeFight:"空",create:"空"}}function u(){e.timeline=r.allTimelines[r.newTimeline()],B()}function y(c){window.scrollTo({top:0,behavior:"smooth"}),e.timeline=c,B()}function v(c){h.fire({title:`确定要删除${c.name}吗？`,text:"这将无法撤回！",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"确认删除",cancelButtonText:"取消"}).then(n=>{n.isConfirmed&&(m(),w.value.splice(w.value.findIndex(z=>z===c),1))})}function s(){r.loadTimelineSettings()}function P(c){const n=new nt(".export",{text:()=>JSON.stringify(c)});n.on("success",()=>{h.fire({position:"top-end",icon:"success",title:"复制成功，已写入剪切板。",showConfirmButton:!1,timer:1500}),n.destroy()}),n.on("error",()=>{h.fire("复制失败，请手动复制！",JSON.stringify([c])),n.destroy()})}function W(){h.fire({title:"输入导出的字符串",input:"text",returnInputValueOnDeny:!0,showDenyButton:!0,denyButtonText:"覆盖",showConfirmButton:!0,confirmButtonText:"追加",showCancelButton:!0,cancelButtonText:"放弃"}).then(c=>{if(c.isConfirmed||c.isDenied)try{c.isDenied?h.fire({title:"这将丢失目前拥有的所有数据，你确定要覆盖吗？",showConfirmButton:!1,showDenyButton:!0,denyButtonText:"确定覆盖",showCancelButton:!0,cancelButtonText:"取消"}).then(n=>{n.isDenied&&(r.allTimelines.length=0,r.allTimelines.push(...JSON.parse(c.value)),r.sortTimelines())}):(r.allTimelines.push(...JSON.parse(c.value)),r.sortTimelines())}catch(n){h.fire({icon:"error",title:"Oops...",text:n})}})}const te=ue(()=>`${(p.value<0?"-":"")+(Array(2).join("0")+(Math.floor(p.value/60)+(p.value<0?1:0))).slice(-2)}:${(Array(2).join("0")+Math.floor(p.value%60)).slice(-2)}`);function ne(){e.timeline.timeline=e.timeline.timeline.replaceAll(new RegExp("(?<=^|#\\s*)(?<time>[:：\\d.]+)","gm"),(c,n)=>/^\d+:\d+(?:\.\d{1,2})?$/.test(c.toString())?Fe.duration(`00:${c.toString()}`).as("seconds").toString():Fe.utc(Number.parseFloat(c.toString())*1e3).format("mm:ss.S"))}function G(){const c=bt.resolve({path:"/timelineHelp"}).href;window.open(c,"_blank")}function g(c){r.configValues=c.configValues,r.showStyle=c.showStyle}const ye=c=>{if(c.source==="soumaTimeline"&&c.msg.type==="post"){U=!1,j.close();const n=c.msg.data;r.allTimelines.length===0&&n.allTimelines.length>r.allTimelines.length&&(r.allTimelines=n.allTimelines,r.configValues=n.configValues,r.showStyle=n.showStyle,ae.closeAll(),ae({message:"数据获取成功",type:"success",duration:3e3}))}};function we(){U=!0,j=it.service({lock:!0,text:"正在请求数据，请确保ACT与时间轴悬浮窗已开启...，若 3 秒内仍未获取到数据，请检查ACT状态，且确认 timeline 悬浮窗已开启。",background:"rgba(0, 0, 0, 0.7)"}),V("get"),setTimeout(()=>{U&&(ae.info("重新尝试获取数据..."),we())},5e3)}function Oe(){lt.confirm("你确定要将当前数据发送至 ACT 悬浮窗吗？悬浮窗中的内容将会被覆盖！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{V("post",r.$state)})}return et(()=>{yt("BroadcastMessage",ye);const c=tt(k,n=>{n&&(we(),c())})}),(c,n)=>{const z=ot,E=pe,T=Se,Z=st,je=at,be=fe,qe=rt,Pe=kt,ze=Vt,Je=Ae,Y=Ve,he=Be,ve=ke,Me=Ue,ie=dt,X=Ie,Re=Ee,Le=ct,He=ut,Ke=mt;return C(),A(Ke,{class:"container"},{default:l(()=>[t(qe,null,{default:l(()=>[t(E,{"m-b-5":""},{default:l(()=>[t(z,{title:"为防止用户数据意外丢失，在编辑完成后，你需要手动点击右侧绿色「将改动应用到 ACT 悬浮窗中」按钮，才会使得改动应用到悬浮窗中。",type:"info"})]),_:1}),t(E,{gutter:10,align:"middle",justify:"space-between"},{default:l(()=>[t(be,{span:20},{default:l(()=>[t(je,{wrap:""},{default:l(()=>[t(Z,null,{default:l(()=>[t(T,{type:"primary",onClick:n[0]||(n[0]=o=>d())},{default:l(()=>[b(" 从 FFlogs 生成 ")]),_:1}),t(T,{type:"primary",onClick:n[1]||(n[1]=o=>_())},{default:l(()=>[b(" 从 在线文档 获取 ")]),_:1}),t(T,{type:"primary",onClick:n[2]||(n[2]=o=>u())},{default:l(()=>[b(" 手动编写 ")]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(T,{onClick:n[3]||(n[3]=o=>W())},{default:l(()=>[b(" 导入字符串 ")]),_:1}),t(T,{class:"export",onClick:n[4]||(n[4]=o=>P(i(w)))},{default:l(()=>[b(" 导出全部 ")]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(T,{onClick:n[5]||(n[5]=o=>G())},{default:l(()=>[b(" 时间轴语法 ")]),_:1})]),_:1}),t(Z,null,{default:l(()=>[t(T,{type:"success",onClick:n[6]||(n[6]=o=>Oe())},{default:l(()=>[b(" 将改动应用到 ACT 悬浮窗中 ")]),_:1})]),_:1})]),_:1})]),_:1}),t(be,{span:4,style:{"text-align":"right"}},{default:l(()=>[t(T,{color:"#626aef",style:{color:"white"},onClick:n[7]||(n[7]=o=>I.value=!0)},{default:l(()=>[b(" 设置 ")]),_:1})]),_:1})]),_:1})]),_:1}),t(Pe,{modelValue:i(I),"onUpdate:modelValue":n[8]||(n[8]=o=>L(I)?I.value=o:null),onSave:g},null,8,["modelValue"]),t(He,null,{default:l(()=>[i($)?(C(),A(ze,{key:0,filters:i(O),onClearCurrentlyTimeline:m,onShowFFlogsToggle:n[9]||(n[9]=()=>$.value=!i($)),onNewTimeline:i(r).newTimeline,onUpdateFilters:i(r).updateFilters},null,8,["filters","onNewTimeline","onUpdateFilters"])):se("",!0),Bt,de(t(ie,null,{default:l(()=>[f("div",At,[Nt,t(Je,{modelValue:i(p),"onUpdate:modelValue":n[10]||(n[10]=o=>L(p)?p.value=o:null),min:-30,max:1500,step:.1,"show-input":""},null,8,["modelValue"]),f("div",null,J(i(te)),1)]),t(E,{class:"timeline-info"},{default:l(()=>[f("div",null,[f("p",Dt,[Ut,t(Y,{modelValue:i(e).timeline.name,"onUpdate:modelValue":n[11]||(n[11]=o=>i(e).timeline.name=o),class:"timeline-info-name"},null,8,["modelValue"])]),f("p",Ot,[jt,t(ve,{modelValue:i(e).timeline.condition.zoneId,"onUpdate:modelValue":n[12]||(n[12]=o=>i(e).timeline.condition.zoneId=o),filterable:""},{default:l(()=>[(C(),R(H,null,Q(F,o=>t(he,{key:o.id,label:o.name,value:o.id},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),f("p",qt,[Pt,t(ve,{modelValue:i(e).timeline.condition.job,"onUpdate:modelValue":n[13]||(n[13]=o=>i(e).timeline.condition.job=o),required:"",placeholder:"职业"},{default:l(()=>[(C(!0),R(H,null,Q(i(K),o=>(C(),A(he,{key:o,label:i(M).nameToFullName(o).cn,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),f("p",zt,[Jt,t(Y,{modelValue:i(e).timeline.codeFight,"onUpdate:modelValue":n[14]||(n[14]=o=>i(e).timeline.codeFight=o),disabled:""},null,8,["modelValue"])]),f("p",Mt,[Rt,t(Y,{modelValue:i(e).timeline.create,"onUpdate:modelValue":n[15]||(n[15]=o=>i(e).timeline.create=o),disabled:""},null,8,["modelValue"])]),t(E,{"m-b-10px":""},{default:l(()=>[t(T,{span:12,class:"export",onClick:n[16]||(n[16]=o=>P([i(e).timeline]))},{default:l(()=>[b(" 单独导出 ")]),_:1}),t(T,{type:"primary",span:12,onClick:n[17]||(n[17]=o=>ne())},{default:l(()=>[b(" 切换时间 ")]),_:1})]),_:1}),t(E,null,{default:l(()=>[t(T,{span:12,type:"danger",onClick:n[18]||(n[18]=o=>v(i(e).timeline))},{default:l(()=>[b(" 删除 ")]),_:1}),t(T,{span:12,onClick:n[19]||(n[19]=o=>m())},{default:l(()=>[b(" 隐藏编辑界面 ")]),_:1})]),_:1})]),f("div",Lt,[t(Y,{modelValue:i(e).timeline.timeline,"onUpdate:modelValue":n[20]||(n[20]=o=>i(e).timeline.timeline=o),class:"timeline-timeline-raw",type:"textarea",rows:12,wrap:"off",placeholder:"请键入时间轴文本",style:{"max-width":"569px"},onChange:n[21]||(n[21]=o=>B())},null,8,["modelValue"])]),f("div",Ht,[f("div",Kt,[t(Me,{config:i(r).configValues,lines:i(S),runtime:i(p),"show-style":i(r).showStyle},null,8,["config","lines","runtime","show-style"])])])]),_:1}),Qt]),_:1},512),[[ce,i(e).timeline.create!=="空"]]),Wt,i(w).length>0?(C(),A(ie,{key:1},{default:l(()=>[t(Re,{data:i(w),style:{width:"100%"},stripe:""},{default:l(()=>[t(X,{prop:"name",label:"名称"}),t(X,{prop:"conditon",label:"地图",sortable:""},{default:l(o=>{var le;return[b(J((le=F.find(Qe=>Qe.id===o.row.condition.zoneId))==null?void 0:le.name),1)]}),_:1}),t(X,{prop:"conditon",label:"职业"},{default:l(o=>[b(J(i(M).nameToFullName(o.row.condition.job).cn),1)]),_:1}),t(X,{fixed:"right",label:"操作",width:"100"},{default:l(o=>[t(T,{type:"primary",size:"small",onClick:le=>y(o.row)},{default:l(()=>[b(" 编辑 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})):se("",!0),i(w).length===0?(C(),A(ie,{key:2},{default:l(()=>[t(Le,{description:"点击上方新建或导入一个时间轴吧~"})]),_:1})):se("",!0)]),_:1})]),_:1})}}});const dn=ge(Gt,[["__scopeId","data-v-a92a159c"]]);export{dn as default};
