import{d as R,I as z,n as d,p as i,q as D,b as O,Y as U,o as m,e as f,t as _,F as k,L as H,u as s,s as P,v as L,a as V,y as E,Q as F}from"./vendor-8bdaa26a.js";import{_ as M}from"./DragJob-716bef9c.js";import{a as v}from"./overlay_plugin_api-409cb9ea.js";import{N as q}from"./netregexes-60f54b26.js";import{j as J}from"./util-6ab7166a.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";const W=R({__name:"showBarrier",setup(Y){z(e=>({"92d710ac":s(N),"2e41421f":s(A)}));const I={statusEffectExplicit:q.statusEffectExplicit()},n=d([]),o=d(""),g=d(window.location.href),u=i(()=>new URLSearchParams(g.value.split("?")[1])),h=i(()=>u.value.get("showSettings")==="1"),N=i(()=>`${Number(u.value.get("lineHeight")||1)*40}px`),A=i(()=>`${Number(u.value.get("fontSize")||26)}px`),y=i(()=>u.value.get("type")||"1");function B(e){var a,x,w;const t=I.statusEffectExplicit.exec(e);if((a=t==null?void 0:t.groups)!=null&&a.targetId.startsWith("1")){const c=n.value.find($=>{var S;return $.id===((S=t.groups)==null?void 0:S.targetId)});c&&(c.barrierPercent=Number((x=t.groups)==null?void 0:x.currentShield),c.barrierAmount=Math.round(Number((w=t.groups)==null?void 0:w.maxHp)*c.barrierPercent/100))}}const l=D("cactbotRuntime-sortArr",J);function C(e){l.value=e}function b(){n.value.sort((e,r)=>e.id===o.value?-1:r.id===o.value?1:e.job===r.job?r.id.localeCompare(e.id):l.value.indexOf(e.job)-l.value.indexOf(r.job))}function j(e){return y.value==="1"?`${e.barrierPercent}`:y.value==="2"?`${e.barrierAmount}`:`${e.barrierPercent}%(${e.barrierAmount})`}let p=0;return O(()=>{v("LogLine",e=>{B(e.rawLine)}),v("PartyChanged",e=>{n.value=e.party.filter(r=>r.inParty).map(r=>({...r,barrierPercent:0,barrierAmount:0}))}),v("ChangePrimaryPlayer",e=>{o.value=Number(e.charID).toString(16).toUpperCase()}),U([n,o,l],()=>{clearInterval(p),o.value?b():p=setInterval(()=>{o.value&&(b(),clearInterval(p))},100)},{immediate:!0}),window.addEventListener("hashchange",e=>g.value=e.newURL)}),(e,r)=>{const t=M;return m(),f("div",null,[_("ul",null,[(m(!0),f(k,null,H(s(n),a=>(m(),f("li",{key:a.id},[P(_("span",{"m-r-2":""},E(a.name),513),[[L,s(h)]]),_("span",{style:F(a.barrierPercent===0?{opacity:.25,color:"white"}:{opacity:1,color:"#f5da3c"})},E(j(a)),5)]))),128))]),P(V(t,{style:{"z-index":"10000"},party:s(n),"m-b-1":"","p-1":"",onUpdateSortArr:C},null,8,["party"]),[[L,s(h)]])])}}});const re=Q(W,[["__scopeId","data-v-54eea9bd"]]);export{re as default};
