import{d as le,y as ae,B as ie,A as w,C as re,D as m,o as z,b as X,h as Y,H as U,u as e,a as s,w as f,g as l,I as i,J as me,K as ue,t as g,S as V,M as de,O as fe,N as ce,a4 as pe,P as ge,Q as Ce,j as we,aL as Ve,k as he,ae as ve}from"./vendor-4119510c.js";import{a as h}from"./overlay_plugin_api-409cb9ea.js";import{g as xe}from"./actionChinese-7b5a1468.js";import{_ as Ae}from"./index-dead135b.js";const Ie={};function Se(v){return Ie[v]}const ye={class:"container"},De={style:{width:"10rem"}},be={class:"noCSS"},_e={class:"noCSS"},ze={class:"actionID"},Xe=le({__name:"castingToChinese",setup(v){var A,I;ae(a=>({"71cdebdd":e(k),"1c9be6b1":e(K),"1c9be6b2":e(M),a6be71fe:e(F),"2394c983":e(L),"31d782cb":e(O),"31d782cc":e(H),f4d652b6:e(B),"50c97cfd":e(q),"50c97cfe":e(W),cf0b1042:e(E),"0b3b9821":e(j),"0b3b9822":e(J)}));const T=new URLSearchParams(window.location.href.split("?")[1]);function P(a){const t=Number.parseInt(a[4],16),r=a[2],d=a[5];return Se(t)||xe(t)||void(r.startsWith("4")&&!d.includes("unknown")&&console.error(`未找到动作 ${t} ${d}`))||d}class N{constructor(t){this.name=P(t),this.startTime=Date.now(),this.castTime=Number(t[8])*1e3,this.overTime=this.startTime+this.castTime,this.actionId=Number.parseInt(t[4],16)}}const u=ie({targetCast:void 0}),$=[{value:"Target",label:"当前目标"},{value:"Focus",label:"焦点目标"}],o=w({width:265,showCountdown:!1,showProgress:!1,showActionChinese:!0,showActionID:!1,offsetProgressX:0,offsetProgressY:-22,offsetCountdownX:265-25,offsetCountdownY:-5,offsetActionChineseX:265+10,offsetActionChineseY:-45,offsetActionIDX:10,offsetActionIDY:-5,ping:80,keep:100,fontSizeCountDown:17,fontSizeActionName:20,fontFamily:"SmartisanHei",targetKey:"Target"});re("castingToChineseFix",o,localStorage,{mergeDefaults:!0});const E=m(()=>`${o.value.width}px`),k=m(()=>o.value.showCountdown?1:0),F=m(()=>o.value.showProgress?1:0),L=m(()=>o.value.showActionChinese?1:0),B=m(()=>o.value.showActionID?1:0),K=m(()=>`${o.value.offsetCountdownX}px`),M=m(()=>`${o.value.offsetCountdownY*-1}px`),O=m(()=>`${o.value.offsetActionChineseX}px`),H=m(()=>`${o.value.offsetActionChineseY*-1}px`),q=m(()=>`${o.value.offsetActionIDX}px`),W=m(()=>`${o.value.offsetActionIDY*-1}px`),j=m(()=>`${o.value.offsetProgressX}px`),J=m(()=>`${o.value.offsetProgressY*-1}px`),c=new Map,p=w(0),C=o.value.ping,x=w(/^(?:1|true|on)$/i.test(T.get("showSettings")||"")||((I=(A=document.getElementById("unlocked"))==null?void 0:A.style)==null?void 0:I.display)==="flex");h("EnmityTargetData",a=>{var t;u.targetCast=c.get((t=a[o.value.targetKey])==null?void 0:t.ID)}),h("LogLine",a=>{a.line[0]==="20"?c.set(Number.parseInt(a.line[2],16),new N(a.line)):a.line[0]==="23"&&c.delete(Number.parseInt(a.line[2],16))}),h("ChangeZone",()=>c.clear()),requestAnimationFrame(function a(){p.value=Date.now(),requestAnimationFrame(a)}),document.addEventListener("onOverlayStateUpdate",a=>{var t;x.value=((t=a==null?void 0:a.detail)==null?void 0:t.isLocked)===!1});function Q(){localStorage.removeItem("castingToChinese"),location.reload()}return(a,t)=>{const r=de,d=fe,R=ce,Z=ve,G=pe,ee=ge,oe=Ce,te=we,ne=Ve,se=he;return z(),X("div",ye,[Y(s(te,{class:"settings"},{default:f(()=>[l("form",null,[i(" 宽度: "),s(r,{modelValue:e(o).width,"onUpdate:modelValue":t[0]||(t[0]=n=>e(o).width=n),min:20,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",null,[i("显示倒计时: "),s(d,{modelValue:e(o).showCountdown,"onUpdate:modelValue":t[1]||(t[1]=n=>e(o).showCountdown=n)},null,8,["modelValue"])]),l("form",null,[i("显示进度条: "),s(d,{modelValue:e(o).showProgress,"onUpdate:modelValue":t[2]||(t[2]=n=>e(o).showProgress=n)},null,8,["modelValue"])]),l("form",null,[i("显示中文: "),s(d,{modelValue:e(o).showActionChinese,"onUpdate:modelValue":t[3]||(t[3]=n=>e(o).showActionChinese=n)},null,8,["modelValue"])]),l("form",null,[i("显示ID: "),s(d,{modelValue:e(o).showActionID,"onUpdate:modelValue":t[4]||(t[4]=n=>e(o).showActionID=n)},null,8,["modelValue"])]),l("form",null,[i(" 延迟(ms): "),s(r,{modelValue:e(o).ping,"onUpdate:modelValue":t[5]||(t[5]=n=>e(o).ping=n),min:0,max:1e4,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",null,[i(" 保留(ms): "),s(r,{modelValue:e(o).keep,"onUpdate:modelValue":t[6]||(t[6]=n=>e(o).keep=n),min:0,max:1e5,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",null,[i(" 进度条偏移X: "),s(r,{modelValue:e(o).offsetProgressX,"onUpdate:modelValue":t[7]||(t[7]=n=>e(o).offsetProgressX=n),min:-1e3,max:1e3,size:"small"},null,8,["modelValue"])]),l("form",null,[i(" 进度条偏移Y: "),s(r,{modelValue:e(o).offsetProgressY,"onUpdate:modelValue":t[8]||(t[8]=n=>e(o).offsetProgressY=n),min:-1e3,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",null,[i(" 倒计时偏移X: "),s(r,{modelValue:e(o).offsetCountdownX,"onUpdate:modelValue":t[9]||(t[9]=n=>e(o).offsetCountdownX=n),min:-1e3,max:1e3,size:"small"},null,8,["modelValue"])]),l("form",null,[i(" 倒计时偏移Y: "),s(r,{modelValue:e(o).offsetCountdownY,"onUpdate:modelValue":t[10]||(t[10]=n=>e(o).offsetCountdownY=n),min:-1e3,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",null,[i(" 中文偏移X: "),s(r,{modelValue:e(o).offsetActionChineseX,"onUpdate:modelValue":t[11]||(t[11]=n=>e(o).offsetActionChineseX=n),min:-1e3,max:1e3,size:"small"},null,8,["modelValue"])]),l("form",null,[i(" 中文偏移Y: "),s(r,{modelValue:e(o).offsetActionChineseY,"onUpdate:modelValue":t[12]||(t[12]=n=>e(o).offsetActionChineseY=n),min:-1e3,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",null,[i(" ID偏移X: "),s(r,{modelValue:e(o).offsetActionIDX,"onUpdate:modelValue":t[13]||(t[13]=n=>e(o).offsetActionIDX=n),min:-1e3,max:1e3,size:"small"},null,8,["modelValue"])]),l("form",null,[i(" ID偏移Y: "),s(r,{modelValue:e(o).offsetActionIDY,"onUpdate:modelValue":t[14]||(t[14]=n=>e(o).offsetActionIDY=n),min:-1e3,max:1e3,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",null,[i(" 倒计时字号(px): "),s(r,{modelValue:e(o).fontSizeCountDown,"onUpdate:modelValue":t[15]||(t[15]=n=>e(o).fontSizeCountDown=n),min:1,max:100,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",null,[i(" 中文字号(px): "),s(r,{modelValue:e(o).fontSizeActionName,"onUpdate:modelValue":t[16]||(t[16]=n=>e(o).fontSizeActionName=n),min:1,max:100,size:"small","controls-position":"right"},null,8,["modelValue"])]),l("form",De,[i(" 字体: "),s(R,{modelValue:e(o).fontFamily,"onUpdate:modelValue":t[17]||(t[17]=n=>e(o).fontFamily=n),size:"small",clearable:"",onClear:t[18]||(t[18]=n=>e(o).fontFamily="SmartisanHei")},null,8,["modelValue"])]),l("form",be,[s(G,{modelValue:e(o).targetKey,"onUpdate:modelValue":t[19]||(t[19]=n=>e(o).targetKey=n),placeholder:"Select",size:"small",teleported:!1},{default:f(()=>[(z(),X(me,null,ue($,n=>s(Z,{key:n.value,label:n.label,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),l("form",_e,[s(oe,{teleported:!1,title:"确定要重置？",onConfirm:Q},{reference:f(()=>[s(ee,null,{default:f(()=>[i("重置全部用户设置")]),_:1})]),_:1})])]),_:1},512),[[U,e(x)]]),Y(s(se,{style:V({fontFamily:e(o).fontFamily})},{default:f(()=>{var n,S,y,D,b,_;return[l("div",{style:V({fontSize:`${e(o).fontSizeCountDown}px`}),class:"countdown"},g(Math.max(((((n=e(u).targetCast)==null?void 0:n.overTime)??1)-e(p)-e(C))/1e3,0).toFixed(2)),5),s(ne,{percentage:Math.min((e(p)-(((S=e(u).targetCast)==null?void 0:S.startTime)??1)+e(C))/(((y=e(u).targetCast)==null?void 0:y.castTime)??1)*100,100),"stroke-width":8,indeterminate:!1,"show-text":!1,color:"#fbfff9",class:"progress"},null,8,["percentage"]),l("div",ze,g((D=e(u).targetCast)==null?void 0:D.actionId)+"("+g((b=e(u).targetCast)==null?void 0:b.actionId.toString(16).toUpperCase())+") ",1),l("div",{style:V({fontSize:`${e(o).fontSizeActionName}px`}),class:"actionChinese"},g((_=e(u).targetCast)==null?void 0:_.name),5)]}),_:1},8,["style"]),[[U,e(u).targetCast&&e(p)-e(u).targetCast.overTime+e(C)<e(o).keep]])])}}});const Ne=Ae(Xe,[["__scopeId","data-v-67860563"]]);export{Ne as default};
