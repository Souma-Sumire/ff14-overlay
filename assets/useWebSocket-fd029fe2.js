import{c as h}from"./overlay_plugin_api-409cb9ea.js";import{A as f}from"./actWS-e2500b62.js";import{n as r,b as m,X as w,T as u}from"./vendor-67b87c3f.js";function P(t){return new Promise((o,s)=>{const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select();try{document.execCommand("copy"),o()}catch(n){s(n)}finally{document.body.removeChild(e)}})}function C(){const t=window.location.href,[o,s=""]=t.split("#"),[e,n=""]=s.split("?"),c=new URLSearchParams(n);let a="";c.forEach((d,i)=>{i!=="OVERLAY_WS"&&(a+=`${i}=${encodeURIComponent(d)}&`)}),a+="OVERLAY_WS=ws://127.0.0.1:10501/ws";let l=o;e&&(l+=`#${e}`,a&&(l+=`?${a}`)),window.location.href=l,location.reload()}function b(t={allowClose:!1}){const o=r(void 0),s=r(!1),e=r(void 0);function n(){Promise.race([h({call:"cactbotRequestState"}),new Promise((a,l)=>{setTimeout(()=>{l(new Error("Timeout"))},1e3)})]).then(()=>{o.value=!0}).catch(()=>{o.value=!1})}function c(){s.value||u.alert(`请按照下图设置<img src='${f}' style='width:100%'>`,t.allowClose?"未连接到 ACT":"未连接到 ACT，无法使用",{dangerouslyUseHTMLString:!0,closeOnClickModal:!1,showClose:!1,closeOnPressEscape:!1,closeOnHashChange:!1,showCancelButton:t.allowClose,showConfirmButton:!1,cancelButtonText:"我偏要看看",buttonSize:"small"}).catch(()=>{s.value=!0})}return m(()=>{w(o,a=>{a?u.close():c()}),window.location.href.includes("OVERLAY_WS")?e.value="overlay":(e.value="websocket",C()),n(),setInterval(()=>{n()},3e3)}),{wsConnected:o,useType:e}}export{P as c,b as u};
